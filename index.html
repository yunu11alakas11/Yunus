<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idiom Master Pro - Final Sunum</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root { 
            --bg: #f4f7f6; --card-bg: #ffffff; --text: #2d3436; --border: #dfe6e9; --accent: #0984e3; 
            --easy: #2ecc71; --normal: #1abc9c; --hard: #f1c40f; --expert: #e67e22; --impossible: #2d3436; 
        }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); color: var(--text); 
            display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; transition: 0.3s;
        }
        .game-card { 
            background: var(--card-bg); padding: 25px; border-radius: 20px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.1); text-align: center; 
            max-width: 900px; width: 100%; position: relative; min-height: 800px; display: flex; flex-direction: column;
        }
        
        /* Navigasyon */
        .top-nav { display: flex; justify-content: space-between; margin-bottom: 20px; gap: 10px; }
        .nav-btn { padding: 10px 20px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; }
        #theme-btn { background: var(--accent); }
        #dict-btn { background: #636e72; }

        /* Impossible Sallanma Animasyonu */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-2px) rotate(-1deg); }
            50% { transform: translateX(2px) rotate(1deg); }
            75% { transform: translateX(-2px) rotate(-1deg); }
            100% { transform: translateX(0); }
        }
        .btn-impossible { 
            background: #000 !important; color: #ff4757 !important; border: 2px solid #ff4757 !important; 
            animation: shake 0.5s infinite; 
        }
        .btn-impossible:hover { background: #ff4757 !important; color: #fff !important; }

        /* Genel Butonlar */
        .btn { 
            padding: 15px; border: 2px solid var(--border); border-radius: 12px; 
            background: transparent; color: var(--text); cursor: pointer; 
            font-weight: bold; transition: 0.2s; width: 100%; font-size: 14px;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn:hover:not(:disabled) { border-color: var(--accent); background: rgba(9, 132, 227, 0.05); }

        /* Oyun Alanƒ± */
        .stats-bar { display: flex; justify-content: space-between; font-weight: bold; padding: 15px; background: #f1f2f6; border-radius: 12px; margin-bottom: 15px; }
        .quiz-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px; }
        .column { display: flex; flex-direction: column; gap: 10px; }
        
        /* Renk Kodlarƒ± */
        .btn-easy { border-color: var(--easy); color: var(--easy); }
        .btn-normal { border-color: var(--normal); color: var(--normal); }
        .btn-hard { border-color: var(--hard); color: var(--hard); }
        .btn-expert { border-color: var(--expert); color: var(--expert); }

        /* ƒ∞lerleme ve Durumlar */
        .progress-container { width: 100%; background: #dfe6e9; border-radius: 10px; margin: 10px 0; height: 10px; overflow: hidden; }
        #progress-fill { height: 100%; background: var(--easy); width: 0%; transition: 0.5s; }
        .selected { border-color: var(--accent) !important; background: #e1f5fe !important; }
        .correct { background: var(--easy) !important; color: white !important; border: none !important; }
        .wrong { background: #ff4757 !important; color: white !important; border: none !important; }
        
        #dictionary-view { 
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: white; z-index: 200; padding: 25px; box-sizing: border-box; overflow-y: auto; border-radius: 20px;
        }
        .day-box { margin-top: 25px; padding: 15px; background: #f1f2f6; border-radius: 15px; }
        .speak-btn { background: none; border: none; cursor: pointer; font-size: 1.2em; }

        /* Firebase Ekstra Stilleri */
        .firebase-stats { font-size: 0.8em; color: var(--accent); margin-bottom: 10px; font-weight: bold; }
        .leaderboard-section { margin-top: 20px; border-top: 2px dashed #ddd; padding-top: 10px; }
        .leaderboard-table { width: 100%; font-size: 0.85em; border-collapse: collapse; }
        .leaderboard-table td { padding: 5px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>

<div class="game-card" id="main-card">
    <div id="fb-visitor" class="firebase-stats">Baƒülanƒ±yor...</div>

    <div class="top-nav">
        <button id="theme-btn" class="nav-btn" onclick="toggleTheme()">üé® Tema</button>
        <button id="dict-btn" class="nav-btn" onclick="toggleDictionary()">üìñ S√∂zl√ºk</button>
    </div>

    <div id="menu">
        <h1 style="margin: 10px 0;">IDIOM MASTER PRO</h1>
        <div style="font-size: 0.9em; color: #636e72; margin-bottom: 20px;">üèÜ Rekorun: <span id="best-score">0</span></div>
        
        <div style="max-width:350px; margin: 0 auto; display:grid; gap:12px;">
            <button class="btn btn-easy" onclick="startGame('easy')">KOLAY SEVƒ∞YE</button>
            <button class="btn btn-normal" onclick="startGame('normal')">ORTA SEVƒ∞YE</button>
            <button class="btn btn-hard" onclick="startGame('hard')">ZOR SEVƒ∞YE</button>
            <button class="btn btn-expert" onclick="startGame('expert')">UZMAN SEVƒ∞YE</button>
            <button class="btn btn-impossible" onclick="startGame('impossible')">ƒ∞MKANSIZ SEVƒ∞YE üíÄ</button>
        </div>

        <div class="leaderboard-section">
            <h4 style="margin:5px;">üåç D√úNYA SIRALAMASI (TOP 5)</h4>
            <table class="leaderboard-table">
                <tbody id="fb-leaderboard">
                    </tbody>
            </table>
        </div>

        <div class="day-box">
            <h4 style="margin:0; color:var(--accent);">G√úN√úN DEYƒ∞Mƒ∞</h4>
            <div id="day-content" style="margin-top:8px;">
                <b id="day-en">...</b> <button class="speak-btn" id="day-speak">üîä</button><br>
                <small id="day-tr" style="color:#636e72;">...</small>
            </div>
        </div>
    </div>

    <div id="dictionary-view">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h3>Deyim K√ºt√ºphanesi (550)</h3>
            <button class="nav-btn" style="background:#333" onclick="toggleDictionary()">Kapat</button>
        </div>
        <div class="progress-container"><div id="progress-fill"></div></div>
        <div id="progress-text" style="font-size:0.8em; margin-bottom:15px;">√ñƒürenilen: 0/550</div>
        <div id="dict-list"></div>
    </div>

    <div id="game" style="display:none; flex-direction:column; height:100%;">
        <div class="stats-bar">
            <span>TUR: <span id="round-val">1</span>/5</span>
            <span>PUAN: <span id="score-val">0</span></span>
        </div>
        <div id="timer-bar" style="width:100%; height:6px; background:#eee; border-radius:3px; margin-bottom:15px; overflow:hidden;">
            <div id="timer-fill" style="width:100%; height:100%; background:var(--accent); transition:0.1s linear;"></div>
        </div>
        <div id="game-area"></div>
        <div style="display:flex; gap:10px; margin-top:20px; justify-content:center;">
            <button id="hint-btn" class="btn" style="width:auto; padding:8px 15px;" onclick="useHint()">üí° ƒ∞pucu (-10)</button>
            <button id="next-btn" class="btn" style="display:none; background:var(--accent); color:white; width:auto;" onclick="nextStep()">Sƒ±radaki Tur ‚ö°</button>
        </div>
    </div>
</div>

<script>
// ########## FIREBASE KURULUMU ##########
const firebaseConfig = {
    apiKey: "AIzaSyC1h5GomEegVsaxLW69WdpAPi7jWeSMiU",
    authDomain: "idiom-master-73674.firebaseapp.com",
    databaseURL: "https://idiom-master-73674-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "idiom-master-73674",
    storageBucket: "idiom-master-73674.appspot.com",
    messagingSenderId: "974516904552",
    appId: "1:974516904552:web:8a5c17ff572241aa0611dd"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// Ziyaret√ßi Sayacƒ± ƒ∞≈ülemi
database.ref('ziyaretci_sayisi').transaction(c => (c || 0) + 1);
database.ref('ziyaretci_sayisi').on('value', snap => {
    document.getElementById('fb-visitor').innerText = "üë• Toplam Ziyaret√ßi: " + snap.val();
});

// D√ºnya Sƒ±ralamasƒ±nƒ± √áekme
database.ref('skorlar').orderByChild('puan').limitToLast(5).on('value', snap => {
    const list = document.getElementById('fb-leaderboard');
    list.innerHTML = "";
    let items = [];
    snap.forEach(c => { items.push(c.val()); });
    items.reverse().forEach((data, i) => {
        list.innerHTML += `<tr><td>${i+1}.</td><td>${data.isim}</td><td><b>${data.puan}</b></td></tr>`;
    });
});

// ########## OYUN VERƒ∞ SETƒ∞ (AYNI KALDI) ##########
const rawData = [
    ["Piece of cake","√áok kolay"],["Time flies","Zaman u√ßar"],["Break a leg","Ba≈üarƒ±lar"],["Good luck","Bol ≈üans"],["Well done","Aferin"],["Take care","Kendine iyi bak"],["Never mind","Bo≈üver"],["Keep it up","Aynen devam"],["Watch out","Dikkat et"],["Come on","Hadi ama"],["Go ahead","Devam et"],["Calm down","Sakin ol"],["Don't worry","Endi≈üelenme"],["Of course","Tabii ki"],["Be careful","Dikkatli ol"],["Slow down","Yava≈üla"],["Hurry up","Acele et"],["Shut up","Kapa √ßeneni"],["Wake up","Uyan"],["Get up","Kalk"],["Sit down","Otur"],["Stand up","Ayaƒüa kalk"],["Listen up","Dinleyin"],["Look out","Dikkat et"],["Turn on","A√ßmak"],["Turn off","Kapatmak"],["Give up","Vazge√ßmek"],["Work out","Egzersiz"],["Find out","Ke≈üfetmek"],["Grow up","B√ºy√ºmek"],["Catch up","Yeti≈ümek"],["Call me","Ara beni"],["Follow me","Takip et"],["I agree","Katƒ±lƒ±yorum"],["Me too","Ben de"],["Not yet","Hen√ºz deƒüil"],["So far","≈ûu ana kadar"],["Right now","Tam ≈üu an"],["At last","Sonunda"],["By the way","Bu arada"],["For sure","Kesinlikle"],["My bad","Benim hatam"],["What's up","Naber"],["How come","Nasƒ±l yani"],["No way","Olamaz"],["Guess what","Bil bakalƒ±m"],["Who knows","Kim bilir"],["Why not","Neden olmasƒ±n"],["See you","G√∂r√º≈ü√ºr√ºz"],["Hold on","Bekle"],["No problem","Sorun deƒüil"],["Help yourself","Buyurun"],["Sounds good","Kulaƒüa ho≈ü"],["Keep going","Devam et"],["Stay calm","Sakin kal"],["Trust me","G√ºven bana"],["Let's go","Hadi gidelim"],["I'm sure","Eminim"],["No doubt","≈û√ºphesiz"],["Be quiet","Sessiz ol"],["Speak up","Sesli konu≈ü"],["Don't panic","Panik yapma"],["I promise","S√∂z veriyorum"],["Excuse me","Afedersiniz"],["Bless you","√áok ya≈üa"],["Cheers","≈ûerefe"],["Have fun","ƒ∞yi eƒülenceler"],["Good night","ƒ∞yi geceler"],["So long","Ho≈ü√ßa kal"],["Take it easy","Rahatƒ±na bak"],["Just kidding","≈ûaka"],["Forget it","Unut gitsin"],["Not bad","Fena deƒüil"],["Pretty good","Bayaƒüƒ± iyi"],["Same here","Ben de"],["Be right back","Hemen d√∂neceƒüim"],["Check it out","≈ûuna bak"],["Count me in","Ben de varƒ±m"],["Get lost","Kaybol"],["Go away","Git ba≈üƒ±mdan"],["Leave me alone","Yalnƒ±z bƒ±rak"],["I'm lost","Kayboldum"],["I'm broke","Parasƒ±zƒ±m"],["I'm full","Tokum"],["I'm home","Evdeyim"],["It depends","Duruma g√∂re"],["It's ok","Sorun yok"],["Keep in touch","ƒ∞leti≈üimde kal"],["Let me know","Haber ver"],["Look at me","Bana bak"],["Try again","Tekrar dene"],["Wait for me","Beni bekle"],["What else","Ba≈üka ne"],["Whatever","Her neyse"],["All right","Pekala"],["Not a bit","Hi√ß deƒüil"],["So be it","√ñyle olsun"],["Carry on","Devam et"],["No thanks","Hayƒ±r te≈üekk√ºrler"],["My pleasure","Zevkle"],["After you","Sizden sonra"],["I'm sorry","√úzg√ºn√ºm"],["I don't know","Bilmiyorum"],["Think so","√ñyle d√º≈ü√ºn√ºyorum"],["I hope so","Umarƒ±m √∂yle"],
    ["Better late than never","Ge√ß olsun g√º√ß olmasƒ±n"],["Call it a day","Paydos etmek"],["Cut corners","Kolaya ka√ßmak"],["Hit the sack","Uyumak"],["Under the weather","Hasta hissetmek"],["On the ball","ƒ∞≈üini bilmek"],["Get over it","A≈ü bunu"],["Hang in there","Dayan"],["So far so good","≈ûimdilik iyi"],["Speak of the devil","ƒ∞ti an √ßomaƒüƒ± hazƒ±rla"],["Break the ice","Buzlarƒ± eritmek"],["Cost an arm and a leg","√áok pahalƒ±"],["Blessing in disguise","Gizli l√ºtuf"],["Bite the bullet","Zorluƒüa katlanmak"],["Miss the boat","Fƒ±rsatƒ± ka√ßƒ±rmak"],["No pain no gain","Emek olmadan olmaz"],["Pull someone's leg","≈ûaka yapmak"],["Best of both worlds","Her iki avantaj"],["Under control","Kontrol altƒ±nda"],["Out of hand","Kontrolden √ßƒ±kmƒ±≈ü"],["Easy does it","Yava≈ü ve dikkatli"],["Cold shoulder","Soƒüuk davranmak"],["Let off the hook","Affetmek"],["Long story short","Uzun lafƒ±n kƒ±sasƒ±"],["The last straw","Son damla"],["Time is money","Vakit nakittir"],["Make matters worse","ƒ∞≈üi yoku≈üa s√ºrmek"],["Eye to eye","Hemfikir olmak"],["Weather the storm","Badireyi atlatmak"],["Wrap your head around","Kavramak"],["Say that again","Kesinlikle haklƒ±sƒ±n"],["Your guess is good","Ben de bilmiyorum"],["Dime a dozen","Sƒ±radan/Bol"],["Add insult to injury","Tuz biber ekmek"],["Beat around the bush","Lafƒ± dolandƒ±rmak"],["Barking up wrong tree","Yanlƒ±≈ü kapƒ± √ßalmak"],["Burn midnight oil","Gece √ßalƒ±≈ümak"],["Judge book by cover","G√∂r√ºn√º≈üe aldanmak"],["Caught red handed","Su√ß√ºst√º"],["Cry over spilled milk","Bo≈üuna √ºz√ºlmek"],["Curiosity killed cat","Merak kediyi √∂ld√ºr√ºr"],["Cut to the chase","Sadede gel"],["Don't count chickens","Dereyi g√∂rmeden pa√ßa"],["Every cloud silver lining","Her ≈üerde hayƒ±r"],["Hit nail on head","Tam √ºst√ºne basmak"],["Kill two birds one stone","Bir ta≈üla iki ku≈ü"],["Let cat out bag","Sƒ±rrƒ± ka√ßƒ±rmak"],["Once in blue moon","Kƒ±rk yƒ±lda bir"],["Piece of the pie","Pay almak"],["Spill the beans","Baklayƒ± √ßƒ±karmak"],["Take with grain of salt","≈û√ºpheyle yakla≈ümak"],["Ball in your court","Top sende"],["Go extra mile","Fazlasƒ±nƒ± yapmak"],["Head over heels","Sƒ±rƒ±lsƒ±klam a≈üƒ±k"],["Heat of the moment","O anƒ±n heyecanƒ±"],["Jump on bandwagon","Modaya uymak"],["Keep at bay","Uzak tutmak"],["Kill with kindness","A≈üƒ±rƒ± nazik olmak"],["Let sleeping dogs lie","E≈üeleme kalsƒ±n"],["Method to madness","Deliliƒüin mantƒ±ƒüƒ±"],["Not playing full deck","Tahtasƒ± eksik"],["Off the hook","Kurtulmu≈ü"],["On the fence","Kararsƒ±z"],["Over the top","Abartƒ±lƒ±"],["Pass the buck","Su√ßu atmak"],["Eggs in one basket","T√ºm riski alma"],["Rain on parade","Keyif ka√ßƒ±rmak"],["Save for rainy day","Zor g√ºn ak√ßesi"],["Sit tight","Sabƒ±rla bekle"],["Smell a rat","Bit yeniƒüi sezmek"],["From horse's mouth","Birinci aƒüƒ±zdan"],["Rain check","Ertelemek"],["Whole nine yards","Tamamƒ±/Hepsi"],["Through thick and thin","ƒ∞yi g√ºnde k√∂t√º g√ºnde"],["Throw in towel","Pes etmek"],["Under the table","El altƒ±ndan"],["Up in the air","Belirsiz"],["Wild goose chase","Bo≈ü uƒüra≈ü"],["Actions speak louder","ƒ∞craata bakƒ±lƒ±r"],["Back to drawing board","Sil ba≈ütan"],["Between rock hard place","ƒ∞ki arada bir derede"],["Bite off more than chew","Boyundan b√ºy√ºk i≈ü"],["Birds of a feather","Tencere kapak"],["Burn bridges","Gemileri yakmak"],["Costs pretty penny","Tuzluya patlamak"],["Cut some slack","M√ºsamaha g√∂stermek"],["Devil's advocate","≈ûeytanƒ±n avukatƒ±"],["Drastic measures","Sert √∂nlemler"],["Elvis has left","≈ûov bitti"],["Far cry from","√áƒ±ok farklƒ±"],["Feel under weather","Keyifsiz"],["Benefit of doubt","≈û√ºpheye raƒümen inan"],["On the grapevine","Kulaƒüƒ±na √ßalƒ±nmak"],["Blink of an eye","G√∂z a√ßƒ±p kapayƒ±nca"],["Two to tango","Tek taraflƒ± olmaz"],["Think big","B√ºy√ºk d√º≈ü√ºn"],["Keep it real","Doƒüal ol"],["No hard feelings","Kƒ±rƒ±lmak yok"],["Last but not least","Sonuncu ama √∂nemli"],["Play it cool","Sakin davran"],["Stay tuned","Takipte kal"],["Up to you","Sana baƒülƒ±"],["Give it a shot","Dene bakalƒ±m"],["Fair and square","Hakkƒ±yla"],["Back on feet","D√ºzelmek"],["Safe and sound","Saƒü salim"],["By all means","Elbette"],["Out of blue","Aniden"],["So to speak","Tabiri caizse"],["As a matter of fact","Aslƒ±nda"],
    ["Keep chin up","Dik dur/√úz√ºlme"],["Leave no stone unturned","Her yere bakmak"],["Like riding bicycle","Unutulmaz ≈üey"],["Look before leap","D√º≈ü√ºnmeden yapma"],["Make ends meet","Ay sonunu getirmek"],["On cloud nine","Mutluluktan u√ßmak"],["Once bitten twice shy","S√ºtten aƒüzƒ± yanan"],["Out of frying pan","Yaƒümurdan doluya"],["Picture thousand words","Resim √ßok ≈üey anlatƒ±r"],["Practice makes perfect","Pratik geli≈ütirir"],["Pull yourself together","Kendine gel"],["Wool over eyes","G√∂z boyamak"],["Rome not built in day","Sabƒ±r gerekir"],["Rule of thumb","G√∂z kararƒ±"],["Run out of steam","Pili bitmek"],["Saved by the bell","Son anda kurtulmak"],["Scapegoat","G√ºnah ke√ßisi"],["Show the ropes","ƒ∞≈ü √∂ƒüretmek"],["Steal thunder","Rol √ßalmak"],["Stick to guns","Kararlƒ± olmak"],["Pinch of salt","Temkinli olmak"],["No free lunch","Bedava peynir olmaz"],["Think outside box","Farklƒ± d√º≈ü√ºnmek"],["Throw caution wind","Riski g√∂ze almak"],["Time heals all","Zaman ila√ßtƒ±r"],["Too many cooks","Nerde √ßokluk"],["Two heads better","Akƒ±l akƒ±ldan √ºst√ºnd√ºr"],["Variety spice of life","Deƒüi≈üiklik iyidir"],["Wrong side of bed","Tersinden kalkmak"],["Heart on sleeve","Duygusu y√ºz√ºnde"],["When in Rome","Uygun davranmak"],["When pigs fly","√áƒ±kmaz ayƒ±n sonu"],["Have cake and eat it","Hem ≈üof√∂r mahalli"],["Zip your lip","√áeneni kapa"],["Hot potato","√áetrefilli konu"],["Against the clock","Zamana kar≈üƒ±"],["All ears","Can kulaƒüƒ±yla"],["Drop of a hat","Hemen"],["Back to square one","En ba≈üa d√∂nmek"],["Black sheep","Y√ºz karasƒ±"],["Blue moon","Nadir olay"],["Break the bank","Servet harcamak"],["Skin of teeth","Kƒ±l payƒ±"],["Cast iron stomach","Saƒülam mide"],["Chew the fat","Geyik yapmak"],["Close no cigar","Yakla≈ütƒ±n ama yok"],["Couch potato","Tembel"],["Cry eyes out","H√ºng√ºrdemek"],["Dead tired","Bitkin"],["Drive up the wall","√áƒ±ldƒ±rtmak"],["Dropping like flies","Telef olmak"],["Eager beaver","Hevesli/√áalƒ±≈ükan"],["Eat humble pie","Hatasƒ±nƒ± kabullenmek"],["Face the music","Bedel √∂demek"],["Flesh and blood","Et ve tƒ±rnak"],["Full of beans","Enerjik"],["Get cold feet","Caymak/Korkmak"],["Get off my back","Rahat bƒ±rak"],["Give a hand","El uzatmak"],["Go cold turkey","Aniden bƒ±rakmak"],["Go with flow","Akƒ±≈üƒ±na bƒ±rakmak"],["Goody two shoes","S√ºt kuzusu"],["Green with envy","Kƒ±skan√ßlƒ±ktan √ßatlamak"],["Have a blast","√áok eƒülenmek"],["Eyes in back of head","Ensesinde g√∂z√º var"],["Head in clouds","Hayalperest"],["Heart in mouth","Y√ºreƒüi aƒüzƒ±nda"],["Hold your horses","Dur bakalƒ±m"],["In hot water","Ba≈üƒ± belada"],["Rings a bell","Tanƒ±dƒ±k geldi"],["Straight face","ƒ∞fadesiz surat"],["Keep shirt on","Sakin ol"],["Kick the bucket","Nallarƒ± dikmek"],["Knock on wood","Tahtaya vur"],["Know the ropes","Yol yordam bilmek"],["Let off steam","Stres atmak"],["Fish out of water","Sudan √ßƒ±kmƒ±≈ü balƒ±k"],["Loose cannon","Tehlikeli tip"],["Mountain out of molehill","Pireyi deve yapmak"],["Money burns hole","Para durmuyor"],["Mum's the word","Aramƒ±zda kalsƒ±n"],["Needle in haystack","Samanlƒ±kta iƒüne"],["Off beaten track","G√∂zden uzak"],["Off the cuff","Doƒüa√ßlama"],["Old habits die hard","Huylu huyundan"],["On the house","M√ºesseseden"],["Pins and needles","Diken √ºst√ºnde"],["Out of the blue","Aniden"],["Over the moon","√áok mutlu"],["Pain in the neck","Ba≈ü belasƒ±"],["Party pooper","Oyunbozan"],["Play by ear","Geli≈üine g√∂re"],["Pull strings","Torpil yapmak"],["Put sock in it","Susmak"],["Foot in mouth","Pot kƒ±rmak"],["Raining cats dogs","Bardaktan bo≈üalƒ±rcasƒ±na"],["Read between lines","ƒ∞mayƒ± anlamak"],["Rock the boat","Sorun √ßƒ±karmak"],["Rolling stone","ƒ∞≈üleyen demir"],["Salt in wound","Yaraya tuz"],["Barking up wrong tree","Yanlƒ±≈ü yere bakmak"],["Blow own trumpet","Kendini √∂vmek"],["Busy as a bee","Arƒ± gibi √ßalƒ±≈ükan"],["Cat's whiskers","M√ºkemmel"],["Diamond in rough","ƒ∞≈ülenmemi≈ü elmas"],["Fit as a fiddle","Turp gibi"],["In seventh heaven","Bulutlarƒ±n √ºst√ºnde"],["Jumping for joy","Sevin√ßten u√ßmak"],["Light as a feather","Ku≈ü gibi hafif"],["Piece of the action","Maceraya katƒ±lmak"],["Read my lips","Aƒüzƒ±mdan √ßƒ±kanƒ± duy"],["See eye to eye","Anla≈ümak"],["Spill the beans","Sƒ±rrƒ± a√ßƒ±klamak"],["Take a back seat","Geri planda kalmak"],["Walk on air","√áok mutlu olmak"],
    ["Run like wind","R√ºzgar gibi ko≈ü"],["Save your breath","Nefesini t√ºketme"],["Second wind","Yeniden g√º√ßlenme"],["Shoot the breeze","Havadan sudan"],["Sitting duck","Kolay hedef"],["Skeleton in closet","Kirli ge√ßmi≈ü"],["Sleep on it","√úst√ºne d√º≈ü√ºnmek"],["Slippery slope","K√∂t√º gidi≈üat"],["Smart cookie","Zeki"],["Sound broken record","Plak gibi takƒ±lmak"],["Spill the tea","Dedikodu yap"],["Stab in back","Sƒ±rtƒ±ndan vurmak"],["Stick nose into","Burnunu sokmak"],["Storm in teacup","Bir ka≈üƒ±k suda fƒ±rtƒ±na"],["Swallow pride","Gururunu yenmek"],["Take a hike","Bas git"],["Take five","Mola ver"],["Third time charm","Hakkƒ± √º√ßt√ºr"],["Through grapevine","S√∂ylentiyle"],["Throw under bus","Ate≈üe atmak"],["Tie the knot","Evlenmek"],["Tip of iceberg","Buzdaƒüƒ±nƒ±n ucu"],["Touch and go","Hassas durum"],["Turn blind eye","G√∂rmezden gel"],["Under the gun","Baskƒ± altƒ±nda"],["Up the creek","Hapƒ± yutmu≈ü"],["Walking on eggshells","Temkinli olmak"],["Water under bridge","Ge√ßmi≈üte kaldƒ±"],["Wear the pants","Patron olmak"],["Wet blanket","Ne≈üesiz tip"],["White lie","Beyaz yalan"],["Wild card","S√ºrpriz fakt√∂r"],["Wolf in sheep","Koyun postunda kurt"],["You bet","Kesinlikle"],["Zero tolerance","Sƒ±fƒ±r tolerans"],["Zip it","Sus"],["Ace up sleeve","Gizli koz"],["Achilles heel","Zayƒ±f nokta"],["All bark no bite","Sadece havlar"],["Apple of eye","G√∂z bebeƒüi"],["Easy as pie","√áocuk oyuncaƒüƒ±"],["Eleventh hour","Son dakika"],["Bad blood","Husumet"],["Big cheese","Patron"],["Black and white","Apa√ßƒ±k"],["Blind date","K√∂r randevu"],["Born yesterday","D√ºnk√º √ßocuk"],["Break new ground","√áƒ±ƒüƒ±r a√ßmak"],["Bring home bacon","Evi ge√ßindirmek"],["Bull in china shop","Z√ºccaciyede fil"],["Burn candle both ends","Kendini t√ºketmek"],["Bury hatchet","Barƒ±≈ümak"],["Busy bee","√áalƒ±≈ükan arƒ±"],["Butterflies in stomach","Karnƒ±nda kelebekler"],["Call shots","Emir vermek"],["Can of worms","Karƒ±≈üƒ±k i≈ü"],["Carrot and stick","√ñd√ºl ve ceza"],["Cat got tongue","Dilini mi yuttun"],["Catch 22","√áƒ±kmaz d√∂ng√º"],["Change of heart","Fikir deƒüi≈üikliƒüi"],["Cheap skate","Cimri"],["Chicken out","Korkup ka√ßmak"],["Clean slate","Beyaz sayfa"],["Clear the air","Sorunu √ß√∂zmek"],["Cold feet","Teredd√ºt"],["Come clean","ƒ∞tiraf etmek"],["Copycat","Taklit√ßi"],["Couch for","Kefil olmak"],["Crack a book","Kitap a√ßmak"],["Crack the code","√á√∂zmek"],["Crash course","Hƒ±zlandƒ±rƒ±lmƒ±≈ü kurs"],["Cream of crop","En iyisi"],["Crocodile tears","Timsah g√∂zya≈ülarƒ±"],["Cross my heart","Yemin ederim"],["Cry wolf","Yalanla kandƒ±rmak"],["Cut the mustard","Beklentiyi a≈ümak"],["Dark horse","Kapalƒ± kutu"],["Dead end","√áƒ±kmaz sokak"],["Deep water","Zor durum"],["Dog eat dog","Acƒ±masƒ±z rekabet"],["Double cross","Kazƒ±k atmak"],["Down to earth","Al√ßakg√∂n√ºll√º"],["Draw the line","Sƒ±nƒ±r √ßizmek"],["Drink like fish","√áok i√ßmek"],["Drop the ball","Hata yapmak"],["Early bird","Erkenci"],["Eat crow","T√ºk√ºrd√ºƒü√ºn√º yalamak"],["Eat dirt","Hakaret i≈üitmek"],["Eat horse","A√ßlƒ±ktan √∂lmek"],["Face value","G√∂r√ºn√ºr deƒüer"],["Fair weather friend","ƒ∞yi g√ºn dostu"],["Fall flat","ƒ∞≈üe yaramamak"],["Fat chance","Zayƒ±f ihtimal"],["Feather in cap","Gurur kaynaƒüƒ±"],["Fifth wheel","Gereksiz ki≈üi"],["Get a grip","Kendini topla"],["Go for broke","Varƒ±nƒ± yoƒüunu koymak"],["Have a cow","Sinirlenmek"],["High as a kite","√áakƒ±rkeyif"],["In a heartbeat","G√∂z a√ßƒ±p kapayƒ±nca"],["Jump the shark","Tadƒ±nƒ± ka√ßƒ±rmak"],["Keep a straight face","Ciddiyetini korumak"],["Laugh head off","G√ºlmekten kƒ±rƒ±lmak"],["Make a long story short","Kƒ±sacasƒ±"],["Neck and neck","At ba≈üƒ±"],["Off the hook","Kurtulmu≈ü"],["On cloud nine","√áok mutlu"],["Pull a fast one","Kandƒ±rmak"],["Ride shotgun","√ñn koltukta gitmek"],["Shake a leg","Acele et"],["Take the plunge","Risk almak"],
    ["Fight fire with fire","Di≈üe di≈ü"],["Fishy","≈û√ºpheli"],["Flat broke","Meteliksiz"],["Fly on wall","Gizli g√∂zlemci"],["Food for thought","D√º≈ü√ºnd√ºr√ºc√º"],["Fool's paradise","Hayal d√ºnyasƒ±"],["Foot the bill","Hesabƒ± √∂demek"],["Full circle","Ba≈üa d√∂nmek"],["Game plan","Strateji"],["Get act together","Kendini toplamak"],["Get axe","Kovulmak"],["Get grip","Kendine gel"],["Get life","Hayatƒ±na bak"],["Get wind of","Kokusunu almak"],["Gift of gab","Laf ebesi"],["Give break","Rahat bƒ±rak"],["Give slip","Atlatmak"],["Go bananas","√áƒ±ldƒ±rmak"],["Go belly up","ƒ∞flas"],["Go dutch","Hesabƒ± b√∂l√º≈ü"],["Go overboard","A≈üƒ±rƒ±ya ka√ßmak"],["Golden opportunity","Altƒ±n fƒ±rsat"],["Good samaritan","Hayƒ±rsever"],["Grain of truth","Doƒüruluk payƒ±"],["Graveyard shift","Gece vardiyasƒ±"],["Grease palm","R√º≈üvet vermek"],["Green light","Onay"],["Grey area","Belirsiz durum"],["Gut feeling","ƒ∞√ßg√ºd√º"],["Hair's breadth","Kƒ±l payƒ±"],["Hand to mouth","Kƒ±t kanaat"],["Hard nut to crack","√áetin ceviz"],["Haste makes waste","Acele i≈üe ≈üeytan"],["Have heart","Merhamet et"],["Heads will roll","Kelleler gidecek"],["Heart of gold","Altƒ±n kalp"],["Heavy heart","√úzg√ºn kalp"],["High and dry","Ortada kalmƒ±≈ü"],["High time","Tam zamanƒ±"],["Hit road","Yola koyulmak"],["Hit spot","Tam isabet"],["Hold tongue","Dilini tut"],["Hold water","Mantƒ±klƒ± olmak"],["Hook line sinker","K√∂r√º k√∂r√ºne"],["Hot air","Bo≈ü laf"],["Icing on cake","Pastanƒ±n √ßileƒüi"],["Idle hands","Bo≈ü duran el"],["In a nutshell","√ñzetle"],["In black and white","Yazƒ±lƒ±"],["In drivers seat","Kontrolde"],["In full swing","Tam gaz"],["In pickle","Zorda"],["In same boat","Aynƒ± gemide"],["Iron out","P√ºr√ºzleri gider"],["Itch to scratch","Can atmak"],["Jack of all trades","On parmaƒüƒ±nda on marifet"],["Jump gun","Erken davranmak"],["Jump ship","Terk etmek"],["Keep company","E≈ülik etmek"],["Keep cool","Sakin kal"],["Keep posted","Haberdar et"],["Keep under wraps","Gizli tut"],["Kick habit","Alƒ±≈ükanlƒ±ƒüƒ± bƒ±rak"],["Kill time","Zaman √∂ld√ºrmek"],["Kiss and makeup","Barƒ±≈ümak"],["Knock socks off","Etkilemek"],["Know beans","Bilmemek"],["Labor of love","G√∂n√ºll√º i≈ü"],["Lame duck","Beceriksiz"],["Land on feet","D√∂rt ayak √ºst√ºne"],["Last ditch","Son √ßare"],["Laughing stock","Alay konusu"],["Lay cards table","Kartlarƒ± a√ßmak"],["Learn by heart","Ezberlemek"],["Leave hanging","Ortada bƒ±rakmak"],["Level playing field","E≈üit ≈üartlar"],["Life of party","Ortamƒ±n ne≈üesi"],["Light at tunnel","Umut ƒ±≈üƒ±ƒüƒ±"],["Lip service","S√∂zde destek"],["Live wire","Enerjik tip"],["Lone wolf","Yalnƒ±z kurt"],["Long shot","Zor ihtimal"],["Lose marbles","Aklƒ±nƒ± ka√ßƒ±rmak"],["Lose shirt","Her ≈üeyi kaybetmek"],["Low hanging fruit","Kolay kazan√ß"],["Lucky break","≈ûans eseri"],["Make waves","Ortalƒ±ƒüƒ± karƒ±≈ütƒ±rmak"],["Man of word","S√∂z√ºn√ºn eri"],["Mean business","Ciddi olmak"],["Midas touch","Altƒ±n dokunu≈ü"],["Nip in the bud","Ba≈üƒ±nda ezmek"],["Not on my watch","Benim g√∂zetimimde deƒüil"],["Once in a blue moon","√áok nadiren"],["Open a can of worms","Ba≈üƒ±nƒ± belaya sokmak"],["Over the top","Abartƒ±lƒ±"],["Penny for thoughts","Ne d√º≈ü√ºn√ºyorsun"],["Quick on the trigger","Eli √ßabuk"],["Rain cats and dogs","Bardaktan bo≈üalƒ±rcasƒ±na"],["Reading tea leaves","Geleceƒüi okumak"],["Salt of the earth","D√ºr√ºst insan"],["Show true colors","Asƒ±l y√ºz√ºn√º g√∂stermek"],["Speak in riddles","Bulmacalƒ± konu≈ümak"],["Take the biscuit","Bu kadarƒ± da fazla"],["Upset the apple cart","Planlarƒ± bozmak"],["Vanish into thin air","Sƒ±rra kadem basmak"],["Wait for the dust to settle","Ortalƒ±ƒüƒ±n yatƒ±≈ümasƒ±nƒ± beklemek"],["Water under the bridge","Ge√ßmi≈ü ge√ßmi≈üte kaldƒ±"],["X marks the spot","Tam burasƒ±"],["You can't judge a book","Dƒ±≈üƒ±na bakƒ±p yargƒ±lama"],["Zest for life","Hayat enerjisi"]
];

const db = rawData.map(i => ({en: i[0], tr: i[1]}));
const pools = {
    easy: db.slice(0, 110), normal: db.slice(110, 220),
    hard: db.slice(220, 330), expert: db.slice(330, 440),
    impossible: db.slice(440, 550)
};

// --- OYUN DURUMU ---
let score = 0, currentRound = 1, currentPool = [], matches = 0, target = 5;
let selE = null, selT = null, timer = null, timeRemaining = 0;
let knownIdioms = JSON.parse(localStorage.getItem('knownIdioms')) || [];
let bestScore = localStorage.getItem('bestScore') || 0;

document.getElementById('best-score').innerText = bestScore;

// --- FONKSƒ∞YONLAR ---
function speak(t) {
    const s = new SpeechSynthesisUtterance(t);
    s.lang = 'en-US'; s.rate = 0.9;
    window.speechSynthesis.speak(s);
}

function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

function startGame(diff) {
    score = 0; currentRound = 1; currentPool = shuffle([...pools[diff]]);
    document.getElementById('menu').style.display = 'none';
    document.getElementById('game').style.display = 'flex';
    document.getElementById('score-val').innerText = score;
    initRound();
}

function initRound() {
    matches = 0; selE = null; selT = null;
    document.getElementById('next-btn').style.display = 'none';
    document.getElementById('round-val').innerText = currentRound;
    
    clearInterval(timer);
    timeRemaining = 25;
    timer = setInterval(() => {
        timeRemaining -= 0.1;
        document.getElementById('timer-fill').style.width = (timeRemaining/25*100) + "%";
        if(timeRemaining <= 0) { clearInterval(timer); gameOver("S√úRE Bƒ∞TTƒ∞!"); }
    }, 100);

    renderBoard();
}

function renderBoard() {
    const area = document.getElementById('game-area');
    area.innerHTML = "";
    const container = document.createElement('div'); container.className = 'quiz-container';
    const colE = document.createElement('div'); colE.className = 'column';
    const colT = document.createElement('div'); colT.className = 'column';

    let roundItems = currentPool.slice((currentRound-1)*target, (currentRound-1)*target + target);
    
    // Karƒ±≈ütƒ±rma Garantisi (Yan yana gelmeyi engeller)
    let engItems = shuffle([...roundItems]);
    let trItems = shuffle([...roundItems]);
    while(engItems.some((item, idx) => item.tr === trItems[idx].tr)) {
        trItems = shuffle(trItems);
    }

    engItems.forEach(i => {
        const b = document.createElement('button'); b.className = 'btn';
        b.innerHTML = `<span>${i.en}</span> <small onclick="event.stopPropagation(); speak('${i.en}')">üîä</small>`;
        b.onclick = () => { if(selE) selE.classList.remove('selected'); selE = b; b.classList.add('selected'); checkMatch(); };
        colE.appendChild(b);
    });

    trItems.forEach(i => {
        const b = document.createElement('button'); b.className = 'btn'; b.innerText = i.tr;
        b.onclick = () => { if(selT) selT.classList.remove('selected'); selT = b; b.classList.add('selected'); checkMatch(); };
        colT.appendChild(b);
    });

    container.append(colE, colT); area.appendChild(container);
}

function checkMatch() {
    if(selE && selT) {
        const enVal = selE.querySelector('span').innerText;
        const correctTr = db.find(x => x.en === enVal).tr;

        if(selT.innerText === correctTr) {
            score += 20;
            selE.className = 'btn correct'; selT.className = 'btn correct';
            selE.disabled = true; selT.disabled = true;
            if(!knownIdioms.includes(enVal)) {
                knownIdioms.push(enVal);
                localStorage.setItem('knownIdioms', JSON.stringify(knownIdioms));
            }
            matches++; selE = null; selT = null;
            if(matches === target) {
                clearInterval(timer);
                document.getElementById('next-btn').style.display = 'block';
            }
        } else {
            score = Math.max(0, score - 5);
            document.getElementById('main-card').classList.add('shake');
            setTimeout(() => document.getElementById('main-card').classList.remove('shake'), 300);
            let e = selE, t = selT; e.className = 'btn wrong'; t.className = 'btn wrong';
            setTimeout(() => { e.className = 'btn'; t.className = 'btn'; e.classList.remove('selected'); t.classList.remove('selected'); }, 500);
            selE = null; selT = null;
        }
        document.getElementById('score-val').innerText = score;
    }
}

function useHint() {
    if(score < 10) return;
    score -= 10; document.getElementById('score-val').innerText = score;
    const firstEnBtn = document.querySelector('.column:first-child .btn:not(:disabled)');
    if(firstEnBtn) {
        const correctTr = db.find(x => x.en === firstEnBtn.querySelector('span').innerText).tr;
        const trBtns = Array.from(document.querySelectorAll('.column:last-child .btn:not(:disabled)'));
        const targetTrBtn = trBtns.find(b => b.innerText === correctTr);
        targetTrBtn.style.background = "#fff9c4";
        setTimeout(() => targetTrBtn.style.background = "", 1000);
    }
}

function nextStep() {
    if(currentRound < 5) { currentRound++; initRound(); }
    else { gameOver("TEBRƒ∞KLER! OYUN Bƒ∞TTƒ∞."); }
}

function gameOver(msg) {
    clearInterval(timer);
    
    // FIREBASE SKOR KAYDETME (EKLEDƒ∞M)
    let pIsmi = prompt("Skorun D√ºnya Sƒ±ralamasƒ±na Kaydedilsin mi? ƒ∞smini Yaz:") || "Anonim";
    database.ref('skorlar').push({
        isim: pIsmi,
        puan: score,
        tarih: Date.now()
    });

    if(score > bestScore) { localStorage.setItem('bestScore', score); }
    
    document.getElementById('game-area').innerHTML = `<h2 style="color:var(--accent)">${msg}</h2><h3>Skorun: ${score}</h3><button class="btn" onclick="location.reload()" style="background:black; color:white; width:200px; margin: 0 auto;">TEKRAR DENE</button>`;
    document.getElementById('next-btn').style.display = 'none';
    document.getElementById('hint-btn').style.display = 'none';
}

function toggleDictionary() {
    const v = document.getElementById('dictionary-view');
    v.style.display = (v.style.display === 'block') ? 'none' : 'block';
    if(v.style.display === 'block') {
        const list = document.getElementById('dict-list'); list.innerHTML = "";
        const progress = (knownIdioms.length / 550) * 100;
        document.getElementById('progress-fill').style.width = progress + "%";
        document.getElementById('progress-text').innerText = `√ñƒürenilen: ${knownIdioms.length}/550`;
        db.forEach(i => {
            const row = document.createElement('div');
            row.style.cssText = "display:flex; justify-content:space-between; padding:8px; border-bottom:1px solid #eee; font-size:0.9em;";
            row.innerHTML = `<span>${knownIdioms.includes(i.en) ? '‚úÖ' : '‚è≥'} <b>${i.en}</b>: ${i.tr}</span><button class="speak-btn" onclick="speak('${i.en}')">üîä</button>`;
            list.appendChild(row);
        });
    }
}

function toggleTheme() {
    const isDark = document.body.style.backgroundColor === 'rgb(24, 25, 26)';
    if(!isDark) { 
        document.body.style.backgroundColor = '#18191a'; 
        document.getElementById('main-card').style.backgroundColor = '#242526';
        document.body.style.color = '#e4e6eb';
    } else { 
        document.body.style.backgroundColor = '#f4f7f6'; 
        document.getElementById('main-card').style.backgroundColor = '#fff';
        document.body.style.color = '#2d3436';
    }
}

// G√ºn√ºn Deyimi (24 saatte bir)
const today = new Date();
const dIdx = (today.getFullYear() * 365 + today.getMonth() * 31 + today.getDate()) % 550;
document.getElementById('day-en').innerText = db[dIdx].en;
document.getElementById('day-tr').innerText = db[dIdx].tr;
document.getElementById('day-speak').onclick = () => speak(db[dIdx].en);

</script>
</body>
</html>