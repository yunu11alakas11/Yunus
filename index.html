<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idiom Master</title>
    <style>
        :root { 
            --bg: #ffffff; --card-bg: #f8f9fa; --text: #333; --border: #ddd; --accent: #2196F3; 
            --easy: #4CAF50; --normal: #009688; --hard: #FF9800; --multihard: #f44336; --impossible: #000000; 
        }
        body { 
            font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); 
            display: flex; flex-direction: column; align-items: center; padding: 20px; 
            transition: 0.5s; min-height: 100vh; margin: 0;
        }
        .game-card { 
            background: var(--card-bg); padding: 20px; border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); text-align: center; 
            max-width: 800px; width: 100%; position: relative; 
            min-height: 750px; display: flex; flex-direction: column; margin-top: 20px;
        }
        
        .top-nav { display: flex; justify-content: space-between; margin-bottom: 20px; gap: 10px; }
        .nav-btn { padding: 10px 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em; color: white; }
        #theme-btn { background: var(--accent); }
        #dict-btn { background: #607d8b; }

        #theme-picker { 
            display: none; position: absolute; top: 60px; left: 20px; background: white; 
            padding: 10px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); 
            z-index: 100; grid-template-columns: repeat(3, 1fr); gap: 5px;
        }
        .color-dot { width: 30px; height: 30px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; }
        .color-dot:hover { border-color: #000; }

        .btn { 
            padding: 14px; border: 2px solid var(--border); border-radius: 12px; 
            background: transparent; color: var(--text); cursor: pointer; 
            font-weight: bold; transition: 0.2s; width: 100%; font-size: 0.95em;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .speak-btn { background: none; border: none; cursor: pointer; font-size: 1.2em; padding: 0 5px; vertical-align: middle; }

        /* Day Idiom Box */
        .day-idiom-box {
            margin-top: 25px; padding: 15px; border-top: 1px dashed #ccc;
            background: rgba(0,0,0,0.03); border-radius: 15px;
        }

        #game { flex: 1; display: flex; flex-direction: column; }
        .stats-bar { display: flex; justify-content: space-between; font-weight: bold; padding: 10px 0; border-bottom: 1px solid #eee; margin-bottom: 15px; }
        .quiz-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: auto 0; }
        .column { display: flex; flex-direction: column; gap: 10px; }

        #dictionary-view { 
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: var(--card-bg); z-index: 200; padding: 20px; box-sizing: border-box; 
            overflow-y: auto; border-radius: 20px; text-align: left;
        }
        .dict-item { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding: 10px 0; }

        @keyframes screenShake { 0%, 100% { transform: translateX(0); } 20%, 60% { transform: translateX(-5px); } 40%, 80% { transform: translateX(5px); } }
        .shake-screen { animation: screenShake 0.4s; }
        .selected { border-color: var(--accent) !important; background: rgba(33, 150, 243, 0.1) !important; }
        .correct { background: var(--easy) !important; color: white !important; border: none !important; }
        .wrong { background: var(--multihard) !important; color: white !important; border: none !important; }

        .btn-easy { border-color: var(--easy); color: var(--easy); }
        .btn-normal { border-color: var(--normal); color: var(--normal); }
        .btn-hard { border-color: var(--hard); color: var(--hard); }
        .btn-multihard { border-color: var(--multihard); color: var(--multihard); }
        .btn-impossible { background: #000; color: #f44336; border-color: #f44336; }
    </style>
</head>
<body>

<div class="game-card" id="main-card">
    <div class="top-nav">
        <button id="theme-btn" class="nav-btn" onclick="toggleThemePicker()">Theme</button>
        <button id="dict-btn" class="nav-btn" onclick="toggleDictionary()">Dictionary</button>
    </div>

    <div id="theme-picker">
        <div class="color-dot" style="background:#2196F3" onclick="setTheme('#2196F3','#ffffff','#333')"></div>
        <div class="color-dot" style="background:#4CAF50" onclick="setTheme('#4CAF50','#ffffff','#333')"></div>
        <div class="color-dot" style="background:#E91E63" onclick="setTheme('#E91E63','#ffffff','#333')"></div>
        <div class="color-dot" style="background:#FF9800" onclick="setTheme('#FF9800','#ffffff','#333')"></div>
        <div class="color-dot" style="background:#9C27B0" onclick="setTheme('#9C27B0','#ffffff','#333')"></div>
        <div class="color-dot" style="background:#333333" onclick="setTheme('#ffeb3b','#222222','#fff')"></div>
    </div>
    
    <div id="menu">
        <h1 style="font-size: 2.2em; margin: 20px 0 10px;">IDIOM MASTER</h1>
        <p style="color:#888; margin-bottom: 20px;">Choose a Challenge</p>
        <div style="max-width:300px; margin: 0 auto; display:flex; flex-direction:column; gap:12px;">
            <button class="btn btn-easy" onclick="startGame('easy')">EASY</button>
            <button class="btn btn-normal" onclick="startGame('normal')">MEDIUM</button>
            <button class="btn btn-hard" onclick="startGame('hard')">HARD</button>
            <button class="btn btn-multihard" onclick="startGame('multihard')">EXPERT</button>
            <button class="btn btn-impossible" onclick="startGame('impossible')">IMPOSSIBLE</button>
        </div>

        <div class="day-idiom-box">
            <h4 style="margin:0 0 5px 0; color:var(--accent);">IDIOM OF THE DAY</h4>
            <div id="day-idiom-content">
                <b id="day-en">...</b> <button class="speak-btn" id="day-speak">ðŸ”Š</button><br>
                <small id="day-tr" style="color:#666;">...</small>
            </div>
        </div>
    </div>

    <div id="dictionary-view">
        <h2 style="margin:0 0 20px 0; border-bottom: 2px solid var(--accent);">Idioms List</h2>
        <div id="dict-list"></div>
        <button class="btn" style="background:var(--accent); color:white; margin-top:20px;" onclick="toggleDictionary()">Back to Menu</button>
    </div>

    <div id="game" style="display:none;">
        <div class="stats-bar">
            <span id="round-display">Round: 1/5</span>
            <span id="score-display">Score: 0</span>
        </div>
        <div id="timer-ui" style="margin-bottom:10px;">
            <div style="width:100%; height:8px; background:#eee; border-radius:5px; overflow:hidden;">
                <div id="timer-fill" style="width:100%; height:100%; background:var(--accent); transition:0.1s linear;"></div>
            </div>
        </div>
        <div id="game-area"></div>
        <button id="action-btn" class="btn" style="display:none; background:var(--accent); color:white; margin-top:20px;" onclick="initLightningQuiz()">Next Stage âš¡</button>
        <button id="menu-btn" class="btn" style="display:none; background:#555; color:white; margin-top:20px;" onclick="location.reload()">Main Menu</button>
    </div>
</div>

<script>
// --- 500 IDIOMS DB (Kompakt) ---
const rawDB = [
    // 1-100: EASY
    ["Piece of cake","Ã‡ok kolay"],["Time flies","Zaman uÃ§ar"],["Break a leg","BaÅŸarÄ±lar"],["Good luck","Bol ÅŸans"],["Well done","Aferin"],["Good job","Ä°yi iÅŸ"],["Take care","Kendine iyi bak"],["Never mind","BoÅŸver"],["Keep it up","Aynen devam"],["Watch out","Dikkat et"],["Come on","Hadi ama"],["Go ahead","Devam et"],["Calm down","Sakin ol"],["Don't worry","EndiÅŸelenme"],["Of course","Tabii ki"],["Be careful","Dikkatli ol"],["Slow down","YavaÅŸla"],["Hurry up","Acele et"],["Shut up","Kapa Ã§eneni"],["Wake up","Uyan"],["Get up","Kalk"],["Sit down","Otur"],["Stand up","AyaÄŸa kalk"],["Listen up","Dinleyin"],["Look out","Dikkat et"],["Turn on","AÃ§mak"],["Turn off","Kapatmak"],["Give up","VazgeÃ§mek"],["Work out","Egzersiz"],["Find out","KeÅŸfetmek"],["Grow up","BÃ¼yÃ¼mek"],["Catch up","YetiÅŸmek"],["Call me","Ara beni"],["Follow me","Takip et"],["I agree","KatÄ±lÄ±yorum"],["Me too","Ben de"],["Not yet","HenÃ¼z deÄŸil"],["So far","Åžu ana kadar"],["Right now","Tam ÅŸu an"],["At last","Sonunda"],["By the way","Bu arada"],["For sure","Kesinlikle"],["My bad","Benim hatam"],["What's up","Naber"],["How come","NasÄ±l yani"],["No way","Olamaz"],["Guess what","Bil bakalÄ±m"],["Who knows","Kim bilir"],["Why not","Neden olmasÄ±n"],["See you","GÃ¶rÃ¼ÅŸÃ¼rÃ¼z"],["Hold on","Bekle"],["No problem","Sorun deÄŸil"],["Help yourself","Buyurun"],["Sounds good","KulaÄŸa hoÅŸ"],["Keep going","Devam et"],["Stay calm","Sakin kal"],["Trust me","GÃ¼ven bana"],["Let's go","Hadi gidelim"],["I'm sure","Eminim"],["No doubt","ÅžÃ¼phesiz"],["Be quiet","Sessiz ol"],["Speak up","Sesli konuÅŸ"],["Don't panic","Panik yapma"],["I promise","SÃ¶z veriyorum"],["Excuse me","Afedersiniz"],["Bless you","Ã‡ok yaÅŸa"],["Cheers","Åžerefe"],["Have fun","Ä°yi eÄŸlenceler"],["Good night","Ä°yi geceler"],["So long","HoÅŸÃ§a kal"],["Take it easy","RahatÄ±na bak"],["Just kidding","Åžaka"],["Forget it","Unut gitsin"],["Not bad","Fena deÄŸil"],["Pretty good","BayaÄŸÄ± iyi"],["Same here","Ben de"],["Be right back","Hemen dÃ¶neceÄŸim"],["Check it out","Åžuna bak"],["Count me in","Ben de varÄ±m"],["Get lost","Kaybol"],["Go away","Git baÅŸÄ±mdan"],["Leave me alone","YalnÄ±z bÄ±rak"],["I'm lost","Kayboldum"],["I'm broke","ParasÄ±zÄ±m"],["I'm full","Tokum"],["I'm home","Evdeyim"],["It depends","Duruma gÃ¶re"],["It's ok","Sorun yok"],["Keep in touch","Ä°letiÅŸimde kal"],["Let me know","Haber ver"],["Look at me","Bana bak"],["Try again","Tekrar dene"],["Wait for me","Beni bekle"],["What else","BaÅŸka ne"],["Whatever","Her neyse"],
    // 101-200: NORMAL
    ["Better late than never","GeÃ§ olsun gÃ¼Ã§ olmasÄ±n"],["Call it a day","Paydos etmek"],["Cut corners","Kolaya kaÃ§mak"],["Hit the sack","Uyumak"],["Under the weather","Hasta hissetmek"],["On the ball","Ä°ÅŸini bilmek"],["Get over it","AÅŸ bunu"],["Hang in there","Dayan"],["So far so good","Åžimdilik iyi"],["Speak of the devil","Ä°ti an Ã§omaÄŸÄ± hazÄ±rla"],["Break the ice","BuzlarÄ± eritmek"],["Cost an arm and a leg","Ã‡ok pahalÄ±"],["Blessing in disguise","Gizli lÃ¼tuf"],["Bite the bullet","ZorluÄŸa katlanmak"],["Miss the boat","FÄ±rsatÄ± kaÃ§Ä±rmak"],["No pain no gain","Emek olmadan olmaz"],["Pull someone's leg","Åžaka yapmak"],["Best of both worlds","Her iki avantaj"],["Under control","Kontrol altÄ±nda"],["Out of hand","Kontrolden Ã§Ä±kmÄ±ÅŸ"],["Easy does it","YavaÅŸ ve dikkatli"],["Cold shoulder","SoÄŸuk davranmak"],["Let off the hook","Affetmek"],["Long story short","Uzun lafÄ±n kÄ±sasÄ±"],["The last straw","Son damla"],["Time is money","Vakit nakittir"],["Make matters worse","Ä°ÅŸi yokuÅŸa sÃ¼rmek"],["Eye to eye","Hemfikir olmak"],["Weather the storm","Badireyi atlatmak"],["Wrap your head around","Kavramak"],["Say that again","Kesinlikle haklÄ±sÄ±n"],["Your guess is good","Ben de bilmiyorum"],["Dime a dozen","SÄ±radan/Bol"],["Add insult to injury","Tuz biber ekmek"],["Beat around the bush","LafÄ± dolandÄ±rmak"],["Barking up wrong tree","YanlÄ±ÅŸ kapÄ± Ã§almak"],["Burn midnight oil","Gece Ã§alÄ±ÅŸmak"],["Judge book by cover","GÃ¶rÃ¼nÃ¼ÅŸe aldanmak"],["Caught red handed","SuÃ§Ã¼stÃ¼"],["Cry over spilled milk","BoÅŸuna Ã¼zÃ¼lmek"],["Curiosity killed cat","Merak kediyi Ã¶ldÃ¼rÃ¼r"],["Cut to the chase","Sadede gel"],["Don't count chickens","Dereyi gÃ¶rmeden paÃ§a"],["Every cloud silver lining","Her ÅŸerde hayÄ±r"],["Hit nail on head","Tam Ã¼stÃ¼ne basmak"],["Kill two birds one stone","Bir taÅŸla iki kuÅŸ"],["Let cat out bag","SÄ±rrÄ± kaÃ§Ä±rmak"],["Once in blue moon","KÄ±rk yÄ±lda bir"],["Piece of the pie","Pay almak"],["Spill the beans","BaklayÄ± Ã§Ä±karmak"],["Take with grain of salt","ÅžÃ¼pheyle yaklaÅŸmak"],["Ball in your court","Top sende"],["Go extra mile","FazlasÄ±nÄ± yapmak"],["Head over heels","SÄ±rÄ±lsÄ±klam aÅŸÄ±k"],["Heat of the moment","O anÄ±n heyecanÄ±"],["Jump on bandwagon","Modaya uymak"],["Keep at bay","Uzak tutmak"],["Kill with kindness","AÅŸÄ±rÄ± nazik olmak"],["Let sleeping dogs lie","EÅŸeleme kalsÄ±n"],["Method to madness","DeliliÄŸin mantÄ±ÄŸÄ±"],["Not playing full deck","TahtasÄ± eksik"],["Off the hook","KurtulmuÅŸ"],["On the fence","KararsÄ±z"],["Over the top","AbartÄ±lÄ±"],["Pass the buck","SuÃ§u atmak"],["Eggs in one basket","TÃ¼m riski alma"],["Rain on parade","Keyif kaÃ§Ä±rmak"],["Save for rainy day","Zor gÃ¼n akÃ§esi"],["Sit tight","SabÄ±rla bekle"],["Smell a rat","Bit yeniÄŸi sezmek"],["From horse's mouth","Birinci aÄŸÄ±zdan"],["Rain check","Ertelemek"],["Whole nine yards","TamamÄ±/Hepsi"],["Through thick and thin","Ä°yi gÃ¼nde kÃ¶tÃ¼ gÃ¼nde"],["Throw in towel","Pes etmek"],["Under the table","El altÄ±ndan"],["Up in the air","Belirsiz"],["Wild goose chase","BoÅŸ uÄŸraÅŸ"],["Actions speak louder","Ä°craata bakÄ±lÄ±r"],["Back to drawing board","Sil baÅŸtan"],["Between rock hard place","Ä°ki arada bir derede"],["Bite off more than chew","Boyundan bÃ¼yÃ¼k iÅŸ"],["Birds of a feather","Tencere kapak"],["Burn bridges","Gemileri yakmak"],["Costs pretty penny","Tuzluya patlamak"],["Cut some slack","MÃ¼samaha gÃ¶stermek"],["Devil's advocate","ÅžeytanÄ±n avukatÄ±"],["Drastic measures","Sert Ã¶nlemler"],["Elvis has left","Åžov bitti"],["Far cry from","Ã‡ok farklÄ±"],["Feel under weather","Keyifsiz"],["Benefit of doubt","ÅžÃ¼pheye raÄŸmen inan"],["On the grapevine","KulaÄŸÄ±na Ã§alÄ±nmak"],["Blink of an eye","GÃ¶z aÃ§Ä±p kapayÄ±nca"],["Two to tango","Tek taraflÄ± olmaz"],
    // 201-300: HARD
    ["Keep chin up","Dik dur/ÃœzÃ¼lme"],["Leave no stone unturned","Her yere bakmak"],["Like riding bicycle","Unutulmaz ÅŸey"],["Look before leap","DÃ¼ÅŸÃ¼nmeden yapma"],["Make ends meet","Ay sonunu getirmek"],["On cloud nine","Mutluluktan uÃ§mak"],["Once bitten twice shy","SÃ¼tten aÄŸzÄ± yanan"],["Out of frying pan","YaÄŸmurdan doluya"],["Picture thousand words","Resim Ã§ok ÅŸey anlatÄ±r"],["Practice makes perfect","Pratik geliÅŸtirir"],["Pull yourself together","Kendine gel"],["Wool over eyes","GÃ¶z boyamak"],["Rome not built in day","SabÄ±r gerekir"],["Rule of thumb","GÃ¶z kararÄ±"],["Run out of steam","Pili bitmek"],["Saved by the bell","Son anda kurtulmak"],["Scapegoat","GÃ¼nah keÃ§isi"],["Show the ropes","Ä°ÅŸ Ã¶ÄŸretmek"],["Steal thunder","Rol Ã§almak"],["Stick to guns","KararlÄ± olmak"],["Pinch of salt","Temkinli olmak"],["No free lunch","Bedava peynir olmaz"],["Think outside box","FarklÄ± dÃ¼ÅŸÃ¼nmek"],["Throw caution wind","Riski gÃ¶ze almak"],["Time heals all","Zaman ilaÃ§tÄ±r"],["Too many cooks","Nerde Ã§okluk"],["Two heads better","AkÄ±l akÄ±ldan Ã¼stÃ¼ndÃ¼r"],["Variety spice of life","DeÄŸiÅŸiklik iyidir"],["Wrong side of bed","Tersinden kalkmak"],["Heart on sleeve","Duygusu yÃ¼zÃ¼nde"],["When in Rome","Uygun davranmak"],["When pigs fly","Ã‡Ä±kmaz ayÄ±n sonu"],["Have cake and eat it","Hem ÅŸofÃ¶r mahalli"],["Zip your lip","Ã‡eneni kapa"],["Hot potato","Ã‡etrefilli konu"],["Against the clock","Zamana karÅŸÄ±"],["All ears","Can kulaÄŸÄ±yla"],["Drop of a hat","Hemen"],["Back to square one","En baÅŸa dÃ¶nmek"],["Black sheep","YÃ¼z karasÄ±"],["Blue moon","Nadir olay"],["Break the bank","Servet harcamak"],["Skin of teeth","KÄ±l payÄ±"],["Cast iron stomach","SaÄŸlam mide"],["Chew the fat","Geyik yapmak"],["Close no cigar","YaklaÅŸtÄ±n ama yok"],["Couch potato","Tembel"],["Cry eyes out","HÃ¼ngÃ¼rdemek"],["Dead tired","Bitkin"],["Drive up the wall","Ã‡Ä±ldÄ±rtmak"],["Dropping like flies","Telef olmak"],["Eager beaver","Hevesli/Ã‡alÄ±ÅŸkan"],["Eat humble pie","HatasÄ±nÄ± kabullenmek"],["Face the music","Bedel Ã¶demek"],["Flesh and blood","Et ve tÄ±rnak"],["Full of beans","Enerjik"],["Get cold feet","Caymak/Korkmak"],["Get off my back","Rahat bÄ±rak"],["Give a hand","El uzatmak"],["Go cold turkey","Aniden bÄ±rakmak"],["Go with flow","AkÄ±ÅŸÄ±na bÄ±rakmak"],["Goody two shoes","SÃ¼t kuzusu"],["Green with envy","KÄ±skanÃ§lÄ±ktan Ã§atlamak"],["Have a blast","Ã‡ok eÄŸlenmek"],["Eyes in back of head","Ensesinde gÃ¶zÃ¼ var"],["Head in clouds","Hayalperest"],["Heart in mouth","YÃ¼reÄŸi aÄŸzÄ±nda"],["Hold your horses","Dur bakalÄ±m"],["In hot water","BaÅŸÄ± belada"],["Rings a bell","TanÄ±dÄ±k geldi"],["Straight face","Ä°fadesiz surat"],["Keep shirt on","Sakin ol"],["Kick the bucket","NallarÄ± dikmek"],["Knock on wood","Tahtaya vur"],["Know the ropes","Yol yordam bilmek"],["Let off steam","Stres atmak"],["Fish out of water","Sudan Ã§Ä±kmÄ±ÅŸ balÄ±k"],["Loose cannon","Tehlikeli tip"],["Mountain out of molehill","Pireyi deve yapmak"],["Money burns hole","Para durmuyor"],["Mum's the word","AramÄ±zda kalsÄ±n"],["Needle in haystack","SamanlÄ±kta iÄŸne"],["Off beaten track","GÃ¶zden uzak"],["Off the cuff","DoÄŸaÃ§lama"],["Old habits die hard","Huylu huyundan"],["On the house","MÃ¼esseseden"],["Pins and needles","Diken Ã¼stÃ¼nde"],["Out of the blue","Aniden"],["Over the moon","Ã‡ok mutlu"],["Pain in the neck","BaÅŸ belasÄ±"],["Party pooper","Oyunbozan"],["Play by ear","GeliÅŸine gÃ¶re"],["Pull strings","Torpil yapmak"],["Put sock in it","Susmak"],["Foot in mouth","Pot kÄ±rmak"],["Raining cats dogs","Bardaktan boÅŸalÄ±rcasÄ±na"],["Read between lines","Ä°mayÄ± anlamak"],["Rock the boat","Sorun Ã§Ä±karmak"],["Rolling stone","Ä°ÅŸleyen demir"],["Salt in wound","Yaraya tuz"],
    // 301-400: EXPERT
    ["Run like wind","RÃ¼zgar gibi koÅŸ"],["Save your breath","Nefesini tÃ¼ketme"],["Second wind","Yeniden gÃ¼Ã§lenme"],["Shoot the breeze","Havadan sudan"],["Sitting duck","Kolay hedef"],["Skeleton in closet","Kirli geÃ§miÅŸ"],["Sleep on it","ÃœstÃ¼ne dÃ¼ÅŸÃ¼nmek"],["Slippery slope","KÃ¶tÃ¼ gidiÅŸat"],["Smart cookie","Zeki"],["Sound broken record","Plak gibi takÄ±lmak"],["Spill the tea","Dedikodu yap"],["Stab in back","SÄ±rtÄ±ndan vurmak"],["Stick nose into","Burnunu sokmak"],["Storm in teacup","Bir kaÅŸÄ±k suda fÄ±rtÄ±na"],["Swallow pride","Gururunu yenmek"],["Take a hike","Bas git"],["Take five","Mola ver"],["Third time charm","HakkÄ± Ã¼Ã§tÃ¼r"],["Through grapevine","SÃ¶ylentiyle"],["Throw under bus","AteÅŸe atmak"],["Tie the knot","Evlenmek"],["Tip of iceberg","BuzdaÄŸÄ±nÄ±n ucu"],["Touch and go","Hassas durum"],["Turn blind eye","GÃ¶rmezden gel"],["Under the gun","BaskÄ± altÄ±nda"],["Up the creek","HapÄ± yutmuÅŸ"],["Walking on eggshells","Temkinli olmak"],["Water under bridge","GeÃ§miÅŸte kaldÄ±"],["Wear the pants","Patron olmak"],["Wet blanket","NeÅŸesiz tip"],["White lie","Beyaz yalan"],["Wild card","SÃ¼rpriz faktÃ¶r"],["Wolf in sheep","Koyun postunda kurt"],["You bet","Kesinlikle"],["Zero tolerance","SÄ±fÄ±r tolerans"],["Zip it","Sus"],["Ace up sleeve","Gizli koz"],["Achilles heel","ZayÄ±f nokta"],["All bark no bite","Sadece havlar"],["Apple of eye","GÃ¶z bebeÄŸi"],["Easy as pie","Ã‡ocuk oyuncaÄŸÄ±"],["Eleventh hour","Son dakika"],["Bad blood","Husumet"],["Big cheese","Patron"],["Black and white","ApaÃ§Ä±k"],["Blind date","KÃ¶r randevu"],["Born yesterday","DÃ¼nkÃ¼ Ã§ocuk"],["Break new ground","Ã‡Ä±ÄŸÄ±r aÃ§mak"],["Bring home bacon","Evi geÃ§indirmek"],["Bull in china shop","ZÃ¼ccaciyede fil"],["Burn candle both ends","Kendini tÃ¼ketmek"],["Bury hatchet","BarÄ±ÅŸmak"],["Busy bee","Ã‡alÄ±ÅŸkan arÄ±"],["Butterflies in stomach","KarnÄ±nda kelebekler"],["Call shots","Emir vermek"],["Can of worms","KarÄ±ÅŸÄ±k iÅŸ"],["Carrot and stick","Ã–dÃ¼l ve ceza"],["Cat got tongue","Dilini mi yuttun"],["Catch 22","Ã‡Ä±kmaz dÃ¶ngÃ¼"],["Change of heart","Fikir deÄŸiÅŸikliÄŸi"],["Cheap skate","Cimri"],["Chicken out","Korkup kaÃ§mak"],["Clean slate","Beyaz sayfa"],["Clear the air","Sorunu Ã§Ã¶zmek"],["Cold feet","TereddÃ¼t"],["Come clean","Ä°tiraf etmek"],["Copycat","TaklitÃ§i"],["Couch for","Kefil olmak"],["Crack a book","Kitap aÃ§mak"],["Crack the code","Ã‡Ã¶zmek"],["Crash course","HÄ±zlandÄ±rÄ±lmÄ±ÅŸ kurs"],["Cream of crop","En iyisi"],["Crocodile tears","Timsah gÃ¶zyaÅŸlarÄ±"],["Cross my heart","Yemin ederim"],["Cry wolf","Yalanla kandÄ±rmak"],["Cut the mustard","Beklentiyi aÅŸmak"],["Dark horse","KapalÄ± kutu"],["Dead end","Ã‡Ä±kmaz sokak"],["Deep water","Zor durum"],["Dog eat dog","AcÄ±masÄ±z rekabet"],["Double cross","KazÄ±k atmak"],["Down to earth","AlÃ§akgÃ¶nÃ¼llÃ¼"],["Draw the line","SÄ±nÄ±r Ã§izmek"],["Drink like fish","Ã‡ok iÃ§mek"],["Drop the ball","Hata yapmak"],["Early bird","Erkenci"],["Eat crow","TÃ¼kÃ¼rdÃ¼ÄŸÃ¼nÃ¼ yalamak"],["Eat dirt","Hakaret iÅŸitmek"],["Eat horse","AÃ§lÄ±ktan Ã¶lmek"],["Face value","GÃ¶rÃ¼nÃ¼r deÄŸer"],["Fair weather friend","Ä°yi gÃ¼n dostu"],["Fall flat","Ä°ÅŸe yaramamak"],["Fat chance","ZayÄ±f ihtimal"],["Feather in cap","Gurur kaynaÄŸÄ±"],["Fifth wheel","Gereksiz kiÅŸi"],
    // 401-500: IMPOSSIBLE
    ["Fight fire with fire","DiÅŸe diÅŸ"],["Fishy","ÅžÃ¼pheli"],["Flat broke","Meteliksiz"],["Fly on wall","Gizli gÃ¶zlemci"],["Food for thought","DÃ¼ÅŸÃ¼ndÃ¼rÃ¼cÃ¼"],["Fool's paradise","Hayal dÃ¼nyasÄ±"],["Foot the bill","HesabÄ± Ã¶demek"],["Full circle","BaÅŸa dÃ¶nmek"],["Game plan","Strateji"],["Get act together","Kendini toplamak"],["Get axe","Kovulmak"],["Get grip","Kendine gel"],["Get life","HayatÄ±na bak"],["Get wind of","Kokusunu almak"],["Gift of gab","Laf ebesi"],["Give break","Rahat bÄ±rak"],["Give slip","Atlatmak"],["Go bananas","Ã‡Ä±ldÄ±rmak"],["Go belly up","Ä°flas"],["Go dutch","HesabÄ± bÃ¶lÃ¼ÅŸ"],["Go overboard","AÅŸÄ±rÄ±ya kaÃ§mak"],["Golden opportunity","AltÄ±n fÄ±rsat"],["Good samaritan","HayÄ±rsever"],["Grain of truth","DoÄŸruluk payÄ±"],["Graveyard shift","Gece vardiyasÄ±"],["Grease palm","RÃ¼ÅŸvet vermek"],["Green light","Onay"],["Grey area","Belirsiz durum"],["Gut feeling","Ä°Ã§gÃ¼dÃ¼"],["Hair's breadth","KÄ±l payÄ±"],["Hand to mouth","KÄ±t kanaat"],["Hard nut to crack","Ã‡etin ceviz"],["Haste makes waste","Acele iÅŸe ÅŸeytan"],["Have heart","Merhamet et"],["Heads will roll","Kelleler gidecek"],["Heart of gold","AltÄ±n kalp"],["Heavy heart","ÃœzgÃ¼n kalp"],["High and dry","Ortada kalmÄ±ÅŸ"],["High time","Tam zamanÄ±"],["Hit road","Yola koyulmak"],["Hit spot","Tam isabet"],["Hold tongue","Dilini tut"],["Hold water","MantÄ±klÄ± olmak"],["Hook line sinker","KÃ¶rÃ¼ kÃ¶rÃ¼ne"],["Hot air","BoÅŸ laf"],["Icing on cake","PastanÄ±n Ã§ileÄŸi"],["Idle hands","BoÅŸ duran el"],["In a nutshell","Ã–zetle"],["In black and white","YazÄ±lÄ±"],["In drivers seat","Kontrolde"],["In full swing","Tam gaz"],["In pickle","Zorda"],["In same boat","AynÄ± gemide"],["Iron out","PÃ¼rÃ¼zleri gider"],["Itch to scratch","Can atmak"],["Jack of all trades","On parmaÄŸÄ±nda on marifet"],["Jump gun","Erken davranmak"],["Jump ship","Terk etmek"],["Keep company","EÅŸlik etmek"],["Keep cool","Sakin kal"],["Keep posted","Haberdar et"],["Keep under wraps","Gizli tut"],["Kick habit","AlÄ±ÅŸkanlÄ±ÄŸÄ± bÄ±rak"],["Kill time","Zaman Ã¶ldÃ¼rmek"],["Kiss and makeup","BarÄ±ÅŸmak"],["Knock socks off","Etkilemek"],["Know beans","Bilmemek"],["Labor of love","GÃ¶nÃ¼llÃ¼ iÅŸ"],["Lame duck","Beceriksiz"],["Land on feet","DÃ¶rt ayak Ã¼stÃ¼ne"],["Last ditch","Son Ã§are"],["Laughing stock","Alay konusu"],["Lay cards table","KartlarÄ± aÃ§mak"],["Learn by heart","Ezberlemek"],["Leave hanging","Ortada bÄ±rakmak"],["Level playing field","EÅŸit ÅŸartlar"],["Life of party","OrtamÄ±n neÅŸesi"],["Light at tunnel","Umut Ä±ÅŸÄ±ÄŸÄ±"],["Lip service","SÃ¶zde destek"],["Live wire","Enerjik tip"],["Lone wolf","YalnÄ±z kurt"],["Long shot","Zor ihtimal"],["Lose marbles","AklÄ±nÄ± kaÃ§Ä±rmak"],["Lose shirt","Her ÅŸeyi kaybetmek"],["Low hanging fruit","Kolay kazanÃ§"],["Lucky break","Åžans eseri"],["Make waves","OrtalÄ±ÄŸÄ± karÄ±ÅŸtÄ±rmak"],["Man of word","SÃ¶zÃ¼nÃ¼n eri"],["Mean business","Ciddi olmak"],["Midas touch","AltÄ±n dokunuÅŸ"]
];

const fullDB = rawDB.map(i => ({en: i[0], tr: i[1]}));
const pools = {
    easy: fullDB.slice(0, 100), normal: fullDB.slice(100, 200),
    hard: fullDB.slice(200, 300), multihard: fullDB.slice(300, 400),
    impossible: fullDB.slice(400, 500)
};

let score = 0, timeLeft = 0, timerInterval, round = 1, matchesFound = 0, targetMatches = 0, currentDiff = '', selectedEng = null, selectedTr = null;
let currentSessionPool = [];

function speak(text) {
    const msg = new SpeechSynthesisUtterance();
    msg.text = text; msg.lang = 'en-US'; msg.rate = 0.9;
    window.speechSynthesis.speak(msg);
}

// Idiom of the Day Logic (Changes every 24h at midnight)
function setDayIdiom() {
    const today = new Date();
    const dateString = today.getFullYear() + "-" + (today.getMonth() + 1) + "-" + today.getDate();
    
    // Simple seed based on date
    let seed = today.getFullYear() * 1000 + today.getMonth() * 100 + today.getDate();
    let index = seed % fullDB.length;
    
    const idiom = fullDB[index];
    document.getElementById('day-en').innerText = idiom.en;
    document.getElementById('day-tr').innerText = idiom.tr;
    document.getElementById('day-speak').onclick = () => speak(idiom.en);
}

function toggleThemePicker() {
    const p = document.getElementById('theme-picker');
    p.style.display = p.style.display === 'grid' ? 'none' : 'grid';
}

function setTheme(accent, bg, text) {
    document.documentElement.style.setProperty('--accent', accent);
    document.body.style.backgroundColor = bg;
    document.body.style.color = text;
    document.getElementById('theme-picker').style.display = 'none';
}

function toggleDictionary() {
    const v = document.getElementById('dictionary-view');
    v.style.display = v.style.display === 'block' ? 'none' : 'block';
    if(v.style.display === 'block') {
        const list = document.getElementById('dict-list');
        list.innerHTML = "";
        fullDB.sort((a,b) => a.en.localeCompare(b.en)).forEach(i => {
            const row = document.createElement('div');
            row.className = 'dict-item';
            row.innerHTML = `<div><b>${i.en}</b><br><small>${i.tr}</small></div>
                             <button class="speak-btn" onclick="speak('${i.en.replace(/'/g, "\\'")}')">ðŸ”Š</button>`;
            list.appendChild(row);
        });
    }
}

function startGame(diff) {
    currentDiff = diff; round = 1; score = 0;
    currentSessionPool = [...pools[diff]].sort(() => Math.random() - 0.5);
    document.getElementById('menu').style.display = 'none';
    document.getElementById('game').style.display = 'flex';
    resetRound();
}

function resetRound() {
    matchesFound = 0; selectedEng = null; selectedTr = null;
    document.getElementById('action-btn').style.display = 'none';
    document.getElementById('round-display').innerText = `Round: ${round}/5`;
    targetMatches = (currentDiff === 'multihard') ? 6 : (currentDiff === 'easy' || currentDiff === 'normal') ? 4 : 5;
    if(currentDiff !== 'easy') {
        let base = (currentDiff === 'impossible') ? 15 : 30;
        timeLeft = base; startTimer(base);
    } else { document.getElementById('timer-ui').style.visibility = 'hidden'; }
    initMatchStage();
}

function startTimer(max) {
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
        timeLeft -= 0.1;
        document.getElementById('timer-fill').style.width = (timeLeft/max*100) + "%";
        if(timeLeft <= 0) { clearInterval(timerInterval); finishGame("TIME UP!"); }
    }, 100);
}

function initMatchStage() {
    const area = document.getElementById('game-area'); area.innerHTML = "";
    const cont = document.createElement('div'); cont.className = 'quiz-container';
    const col1 = document.createElement('div'); col1.className = 'column';
    const col2 = document.createElement('div'); col2.className = 'column';
    let items = currentSessionPool.slice((round-1)*targetMatches, (round-1)*targetMatches + targetMatches);
    items.forEach(i => {
        const b = document.createElement('button'); b.className = 'btn btn-'+currentDiff;
        b.innerHTML = `<span>${i.en}</span><span onclick="event.stopPropagation(); speak('${i.en.replace(/'/g, "\\'")}')">ðŸ”Š</span>`;
        b.onclick = () => { if(selectedEng) selectedEng.classList.remove('selected'); selectedEng = b; b.classList.add('selected'); checkMatch(); };
        col1.appendChild(b);
    });
    [...items].sort(() => Math.random() - 0.5).forEach(i => {
        const b = document.createElement('button'); b.className = 'btn btn-'+currentDiff; b.innerText = i.tr;
        b.onclick = () => { if(selectedTr) selectedTr.classList.remove('selected'); selectedTr = b; b.classList.add('selected'); checkMatch(); };
        col2.appendChild(b);
    });
    cont.append(col1, col2); area.appendChild(cont);
}

function checkMatch() {
    if(selectedEng && selectedTr) {
        const engText = selectedEng.querySelector('span').innerText;
        const isCorrect = fullDB.some(i => i.en === engText && i.tr === selectedTr.innerText);
        if(isCorrect) {
            score += 20; selectedEng.className = 'btn correct'; selectedTr.className = 'btn correct';
            selectedEng.disabled = true; selectedTr.disabled = true;
            matchesFound++; selectedEng = null; selectedTr = null;
            if(matchesFound === targetMatches) document.getElementById('action-btn').style.display = 'block';
        } else {
            score = Math.max(0, score - 5);
            document.getElementById('main-card').classList.add('shake-screen');
            setTimeout(() => document.getElementById('main-card').classList.remove('shake-screen'), 400);
            let e = selectedEng, t = selectedTr; e.className = 'btn wrong'; t.className = 'btn wrong';
            setTimeout(() => { e.className = 'btn btn-'+currentDiff; t.className = 'btn btn-'+currentDiff; e.classList.remove('selected'); t.classList.remove('selected'); }, 400);
            selectedEng = null; selectedTr = null;
        }
        document.getElementById('score-display').innerText = `Score: ${score}`;
    }
}

function initLightningQuiz() {
    document.getElementById('action-btn').style.display = 'none';
    if(currentDiff !== 'easy') { timeLeft = 7; startTimer(7); }
    const area = document.getElementById('game-area');
    const correct = fullDB[Math.floor(Math.random()*fullDB.length)];
    area.innerHTML = `<h3>LIGHTNING QUIZ!</h3><p style="font-size:1.2em">"${correct.en}" 
                      <button class="speak-btn" onclick="speak('${correct.en.replace(/'/g, "\\'")}')">ðŸ”Š</button></p>`;
    let opts = [correct.tr];
    while(opts.length < 4) {
        let r = fullDB[Math.floor(Math.random()*fullDB.length)].tr;
        if(!opts.includes(r)) opts.push(r);
    }
    opts.sort(() => Math.random() - 0.5).forEach(opt => {
        const b = document.createElement('button'); b.className = 'btn btn-'+currentDiff; b.innerText = opt;
        b.onclick = () => {
            if(opt === correct.tr) {
                score += 50; if(round < 5) { round++; resetRound(); } else { finishGame("COMPLETED!"); }
            } else { finishGame("WRONG ANSWER!"); }
        };
        area.appendChild(b);
    });
}

function finishGame(msg) {
    clearInterval(timerInterval);
    document.getElementById('game-area').innerHTML = `<h2>${msg}</h2><h3>Final Score: ${score}</h3>`;
    document.getElementById('menu-btn').style.display = 'block';
}

// Start Init
setDayIdiom();
</script>
</body>
</html>