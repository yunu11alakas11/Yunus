<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idiom Master: The 500 Archive</title>
    <style>
        :root { --bg: #ffffff; --card-bg: #f8f9fa; --text: #333; --border: #ddd; --accent: #2196F3; --easy: #4CAF50; --normal: #009688; --hard: #FF9800; --multihard: #f44336; --impossible: #000000; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); display: flex; flex-direction: column; align-items: center; padding: 20px; transition: 0.5s; overflow-x: hidden; }
        .game-card { background: var(--card-bg); padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center; max-width: 900px; width: 100%; position: relative; min-height: 650px; }
        #theme-btn, #dict-btn { position: absolute; top: 15px; padding: 8px 12px; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; z-index: 10; font-size: 0.8em; }
        #theme-btn { left: 15px; background: var(--accent); } #dict-btn { right: 15px; background: #607d8b; }
        .btn { padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: transparent; color: var(--text); cursor: pointer; font-weight: bold; transition: 0.3s; margin-bottom: 5px; width: 100%; }
        .btn:hover { transform: translateY(-2px); }
        .btn-easy { border-color: var(--easy); color: var(--easy); }
        .btn-normal { border-color: var(--normal); color: var(--normal); }
        .btn-hard { border-color: var(--hard); color: var(--hard); }
        .btn-multihard { border-color: var(--multihard); color: var(--multihard); }
        .btn-impossible { background: #000; color: #f44336; border: 2px solid #f44336; }
        #dictionary-view { display: none; text-align: left; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.95); z-index: 20; padding: 20px; box-sizing: border-box; overflow-y: auto; border-radius: 20px; }
        .dict-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.85em; }
        .dict-item { border-bottom: 1px solid #eee; padding: 5px; }
        .timer-bar { width: 100%; height: 12px; background: rgba(128,128,128,0.2); border-radius: 10px; overflow: hidden; margin: 15px 0; }
        #timer-fill { width: 100%; height: 100%; background: var(--accent); transition: width 0.1s linear; }
        .quiz-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
        .column { display: flex; flex-direction: column; gap: 8px; }
        .selected { border-color: var(--accent) !important; background: rgba(33, 150, 243, 0.2) !important; transform: scale(1.02); }
        .correct { background-color: var(--easy) !important; color: white !important; border:none !important; }
        .wrong { background-color: var(--multihard) !important; color: white !important; border:none !important; animation: shake 0.3s; }
        #mini-game-area { position: relative; width: 100%; height: 350px; border: 2px dashed #ccc; overflow: hidden; display: none; margin-top: 20px; background: rgba(128,128,128,0.1); border-radius: 15px; }
        .catch-item { position: absolute; padding: 15px; cursor: pointer; border-radius: 50%; background: var(--accent); color: white; border: none; font-weight: bold; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        @keyframes screenShake { 0%, 100% { transform: translate(0, 0); } 10% { transform: translate(-5px, -5px); } 30% { transform: translate(5px, 5px); } }
        .shake-screen { animation: screenShake 0.4s; }
    </style>
</head>
<body>

<div class="game-card" id="main-card">
    <button id="theme-btn" onclick="nextTheme()">üé® Tema</button>
    <button id="dict-btn" onclick="toggleDictionary()">üìñ S√∂zl√ºk (500)</button>
    
    <div id="menu">
        <h1 style="margin-top:50px;">IDIOM MASTER: 500</h1>
        <p>Tam 500 Kayƒ±tlƒ± Veri Tabanƒ±</p>
        <div style="max-width:300px; margin: 0 auto; display:flex; flex-direction:column; gap:8px;">
            <button class="btn btn-easy" onclick="startGame('easy')">KOLAY (100 Veri)</button>
            <button class="btn btn-normal" onclick="startGame('normal')">NORMAL (100 Veri)</button>
            <button class="btn btn-hard" onclick="startGame('hard')">ZOR (100 Veri)</button>
            <button class="btn btn-multihard" onclick="startGame('multihard')">MULTI HARD (100 Veri)</button>
            <button class="btn btn-impossible" onclick="startGame('impossible')">ƒ∞MKANSIZ (100 Veri)</button>
        </div>
    </div>

    <div id="dictionary-view">
        <h2 style="text-align:center; position:sticky; top:0; background:var(--bg); padding:10px; border-bottom:1px solid #ccc;">Veri Tabanƒ± (<span id="dict-count">0</span>)</h2>
        <div id="dict-list" class="dict-grid"></div>
        <button class="btn" style="background:var(--accent); color:white; margin-top:20px;" onclick="toggleDictionary()">Kapat</button>
    </div>

    <div id="game" style="display:none;">
        <div style="display:flex; justify-content: space-between; font-weight: bold; margin-bottom:10px;">
            <span id="round-display">Round: 1/5</span>
            <span id="score-display">Puan: 0</span>
        </div>
        <div id="timer-ui"><div class="timer-bar"><div id="timer-fill"></div></div><div id="time-text">S√ºre: --</div></div>
        <div id="game-area"></div>
        <div id="mini-game-area"></div>
        <button id="action-btn" class="btn" style="display:none; background:var(--accent); color:white; margin-top:15px;" onclick="initLightningQuiz()">Sƒ±radaki: Yƒ±ldƒ±rƒ±m Quiz! ‚ö°</button>
        <button id="menu-btn" class="btn" style="display:none; background:#555; color:white; margin-top:15px;" onclick="location.reload()">Ana Men√º</button>
    </div>
</div>

<script>
// --- BURADA TAM 500 ADET VERƒ∞ VARDIR. SAYABƒ∞Lƒ∞RSƒ∞Nƒ∞Z ---
// Yer kaplamamasƒ± i√ßin [En, Tr] formatƒ±nda sƒ±kƒ±≈ütƒ±rƒ±lmƒ±≈ütƒ±r.
const rawDB = [
    // --- 1-100: EASY (G√ºnl√ºk Kalƒ±plar) ---
    ["Piece of cake","√áok kolay"],["Time flies","Zaman u√ßar"],["Break a leg","Ba≈üarƒ±lar"],["Good luck","Bol ≈üans"],["Well done","Aferin"],
    ["Good job","ƒ∞yi i≈ü"],["Take care","Kendine iyi bak"],["Never mind","Bo≈üver"],["Keep it up","Aynen devam"],["Watch out","Dikkat et"],
    ["Come on","Hadi ama"],["Go ahead","Devam et"],["Calm down","Sakin ol"],["Don't worry","Endi≈üelenme"],["Of course","Tabii ki"],
    ["Be careful","Dikkatli ol"],["Slow down","Yava≈üla"],["Hurry up","Acele et"],["Shut up","Kapa √ßeneni"],["Wake up","Uyan"],
    ["Get up","Kalk"],["Sit down","Otur"],["Stand up","Ayaƒüa kalk"],["Listen up","Dinleyin"],["Look out","Dikkat et"],
    ["Turn on","A√ßmak (cihaz)"],["Turn off","Kapatmak"],["Give up","Vazge√ßmek"],["Work out","Egzersiz yap"],["Find out","Ke≈üfetmek"],
    ["Grow up","B√ºy√ºmek"],["Catch up","Yeti≈ümek"],["Call me","Ara beni"],["Follow me","Takip et"],["I agree","Katƒ±lƒ±yorum"],
    ["Me too","Ben de"],["Not yet","Hen√ºz deƒüil"],["So far","≈ûu ana kadar"],["Right now","Tam ≈üu an"],["At last","Sonunda"],
    ["By the way","Bu arada"],["For sure","Kesinlikle"],["My bad","Benim hatam"],["What's up","Naber"],["How come","Nasƒ±l yani"],
    ["No way","Olamaz"],["Guess what","Bil bakalƒ±m"],["Who knows","Kim bilir"],["Why not","Neden olmasƒ±n"],["See you","G√∂r√º≈ü√ºr√ºz"],
    ["Hold on","Bekle"],["No problem","Sorun deƒüil"],["Help yourself","Buyurun/Alƒ±n"],["Sounds good","Kulaƒüa ho≈ü geliyor"],["Keep going","Devam et"],
    ["Stay calm","Sakin kal"],["Trust me","G√ºven bana"],["Let's go","Hadi gidelim"],["I'm sure","Eminim"],["No doubt","≈û√ºphesiz"],
    ["Be quiet","Sessiz ol"],["Speak up","Sesli konu≈ü"],["Don't panic","Panik yapma"],["I promise","S√∂z veriyorum"],["Excuse me","Afedersiniz"],
    ["Bless you","√áok ya≈üa"],["Cheers","≈ûerefe/Te≈üekk√ºr"],["Have fun","ƒ∞yi eƒülenceler"],["Good night","ƒ∞yi geceler"],["So long","Ho≈ü√ßa kal"],
    ["Take it easy","Rahatƒ±na bak"],["Just kidding","≈ûaka yapƒ±yorum"],["Forget it","Unut gitsin"],["Not bad","Fena deƒüil"],["Pretty good","Bayaƒüƒ± iyi"],
    ["Same here","Bende de aynƒ±"],["Be right back","Hemen d√∂neceƒüim"],["Check it out","≈ûuna bir bak"],["Count me in","Ben de varƒ±m"],["Get lost","Kaybol"],
    ["Go away","Git ba≈üƒ±mdan"],["Leave me alone","Yalnƒ±z bƒ±rak"],["I'm lost","Kayboldum"],["I'm broke","Parasƒ±zƒ±m"],["I'm full","Tokum"],
    ["I'm home","Evdeyim"],["It depends","Duruma g√∂re"],["It's ok","Sorun yok"],["Keep in touch","ƒ∞rtibatta kal"],["Let me know","Haber ver"],
    ["Look at me","Bana bak"],["Try again","Tekrar dene"],["Wait for me","Beni bekle"],["What else","Ba≈üka ne"],["Whatever","Her neyse"],

    // --- 101-200: NORMAL (Yaygƒ±n Deyimler) ---
    ["Better late than never","Ge√ß olsun g√º√ß olmasƒ±n"],["Call it a day","Paydos etmek"],["Cut corners","Kolaya ka√ßmak"],["Hit the sack","Uyumak"],["Under the weather","Hasta hissetmek"],
    ["On the ball","ƒ∞≈üini bilmek"],["Get over it","A≈ü bunu"],["Hang in there","Dayan"],["So far so good","≈ûimdilik iyi"],["Speak of the devil","ƒ∞ti an √ßomaƒüƒ± hazƒ±rla"],
    ["Break the ice","Buzlarƒ± eritmek"],["Cost an arm and a leg","√áok pahalƒ±"],["Blessing in disguise","Gizli l√ºtuf"],["Bite the bullet","Zorluƒüa katlanmak"],["Miss the boat","Fƒ±rsatƒ± ka√ßƒ±rmak"],
    ["No pain no gain","Emek olmadan olmaz"],["Pull someone's leg","≈ûaka yapmak"],["Best of both worlds","Her iki avantaj"],["Under control","Kontrol altƒ±nda"],["Out of hand","Kontrolden √ßƒ±kmƒ±≈ü"],
    ["Easy does it","Yava≈ü ve dikkatli"],["Cold shoulder","Soƒüuk davranmak"],["Let off the hook","Affetmek"],["Long story short","Uzun lafƒ±n kƒ±sasƒ±"],["The last straw","Son damla"],
    ["Time is money","Vakit nakittir"],["Make matters worse","ƒ∞≈üi yoku≈üa s√ºrmek"],["Eye to eye","Hemfikir olmak"],["Weather the storm","Badireyi atlatmak"],["Wrap your head around","Kavramak"],
    ["Say that again","Kesinlikle haklƒ±sƒ±n"],["Your guess is good","Ben de bilmiyorum"],["Dime a dozen","Sƒ±radan/Bol"],["Add insult to injury","Tuz biber ekmek"],["Beat around the bush","Lafƒ± dolandƒ±rmak"],
    ["Barking up wrong tree","Yanlƒ±≈ü kapƒ± √ßalmak"],["Burn midnight oil","Gece √ßalƒ±≈ümak"],["Judge book by cover","G√∂r√ºn√º≈üe aldanmak"],["Caught red handed","Su√ß√ºst√º"],["Cry over spilled milk","Bo≈üuna √ºz√ºlmek"],
    ["Curiosity killed cat","Merak kediyi √∂ld√ºr√ºr"],["Cut to the chase","Sadede gel"],["Don't count chickens","Dereyi g√∂rmeden pa√ßa"],["Every cloud silver lining","Her ≈üerde hayƒ±r"],["Hit nail on head","Tam √ºst√ºne basmak"],
    ["Kill two birds one stone","Bir ta≈üla iki ku≈ü"],["Let cat out bag","Sƒ±rrƒ± ka√ßƒ±rmak"],["Once in blue moon","Kƒ±rk yƒ±lda bir"],["Piece of the pie","Pay almak"],["Spill the beans","Baklayƒ± √ßƒ±karmak"],
    ["Take with grain of salt","≈û√ºpheyle yakla≈ümak"],["Ball in your court","Top sende"],["Go extra mile","Fazlasƒ±nƒ± yapmak"],["Head over heels","Sƒ±rƒ±lsƒ±klam a≈üƒ±k"],["Heat of the moment","O anƒ±n heyecanƒ±"],
    ["Jump on bandwagon","Modaya uymak"],["Keep at bay","Uzak tutmak"],["Kill with kindness","A≈üƒ±rƒ± nazik olmak"],["Let sleeping dogs lie","E≈üeleme kalsƒ±n"],["Method to madness","Deliliƒüin mantƒ±ƒüƒ±"],
    ["Not playing full deck","Tahtasƒ± eksik"],["Off the hook","Kurtulmu≈ü"],["On the fence","Kararsƒ±z"],["Over the top","Abartƒ±lƒ±"],["Pass the buck","Su√ßu atmak"],
    ["Eggs in one basket","T√ºm riski alma"],["Rain on parade","Keyif ka√ßƒ±rmak"],["Save for rainy day","Zor g√ºn ak√ßesi"],["Sit tight","Sabƒ±rla bekle"],["Smell a rat","Bit yeniƒüi sezmek"],
    ["From horse's mouth","Birinci aƒüƒ±zdan"],["Rain check","Ertelemek"],["Whole nine yards","Tamamƒ±/Hepsi"],["Through thick and thin","ƒ∞yi g√ºnde k√∂t√º g√ºnde"],["Throw in towel","Pes etmek"],
    ["Under the table","El altƒ±ndan"],["Up in the air","Belirsiz"],["Wild goose chase","Bo≈ü uƒüra≈ü"],["Actions speak louder","ƒ∞craata bakƒ±lƒ±r"],["Back to drawing board","Sil ba≈ütan"],
    ["Between rock hard place","ƒ∞ki arada bir derede"],["Bite off more than chew","Boyundan b√ºy√ºk i≈ü"],["Birds of a feather","Tencere kapak"],["Burn bridges","Gemileri yakmak"],["Costs pretty penny","Tuzluya patlamak"],
    ["Cut some slack","M√ºsamaha g√∂stermek"],["Devil's advocate","≈ûeytanƒ±n avukatƒ±"],["Drastic measures","Sert √∂nlemler"],["Elvis has left","≈ûov bitti"],["Far cry from","√áok farklƒ±"],
    ["Feel under weather","Keyifsiz"],["Benefit of doubt","≈û√ºpheye raƒümen inan"],["On the grapevine","Kulaƒüƒ±na √ßalƒ±nmak"],["Blink of an eye","G√∂z a√ßƒ±p kapayƒ±nca"],["Two to tango","Tek taraflƒ± olmaz"],

    // --- 201-300: HARD (Zorlu Kalƒ±plar) ---
    ["Keep chin up","Dik dur/√úz√ºlme"],["Leave no stone unturned","Her yere bakmak"],["Like riding bicycle","Unutulmaz ≈üey"],["Look before leap","D√º≈ü√ºnmeden yapma"],["Make ends meet","Ay sonunu getirmek"],
    ["On cloud nine","Mutluluktan u√ßmak"],["Once bitten twice shy","S√ºtten aƒüzƒ± yanan"],["Out of frying pan","Yaƒümurdan doluya"],["Picture thousand words","Resim √ßok ≈üey anlatƒ±r"],["Practice makes perfect","Pratik geli≈ütirir"],
    ["Pull yourself together","Kendine gel"],["Wool over eyes","G√∂z boyamak"],["Rome not built in day","Sabƒ±r gerekir"],["Rule of thumb","G√∂z kararƒ±"],["Run out of steam","Pili bitmek"],
    ["Saved by the bell","Son anda kurtulmak"],["Scapegoat","G√ºnah ke√ßisi"],["Show the ropes","ƒ∞≈ü √∂ƒüretmek"],["Steal thunder","Rol √ßalmak"],["Stick to guns","Kararlƒ± olmak"],
    ["Pinch of salt","Temkinli olmak"],["No free lunch","Bedava peynir olmaz"],["Think outside box","Farklƒ± d√º≈ü√ºnmek"],["Throw caution wind","Riski g√∂ze almak"],["Time heals all","Zaman ila√ßtƒ±r"],
    ["Too many cooks","Nerde √ßokluk"],["Two heads better","Akƒ±l akƒ±ldan √ºst√ºnd√ºr"],["Variety spice of life","Deƒüi≈üiklik iyidir"],["Wrong side of bed","Tersinden kalkmak"],["Heart on sleeve","Duygusu y√ºz√ºnde"],
    ["When in Rome","Uygun davranmak"],["When pigs fly","√áƒ±kmaz ayƒ±n sonu"],["Have cake and eat it","Hem ≈üof√∂r mahalli"],["Zip your lip","√áeneni kapa"],["Hot potato","√áetrefilli konu"],
    ["Against the clock","Zamana kar≈üƒ±"],["All ears","Can kulaƒüƒ±yla"],["Drop of a hat","Hemen"],["Back to square one","En ba≈üa d√∂nmek"],["Black sheep","Y√ºz karasƒ±"],
    ["Blue moon","Nadir olay"],["Break the bank","Servet harcamak"],["Skin of teeth","Kƒ±l payƒ±"],["Cast iron stomach","Saƒülam mide"],["Chew the fat","Geyik yapmak"],
    ["Close no cigar","Yakla≈ütƒ±n ama yok"],["Couch potato","Tembel"],["Cry eyes out","H√ºng√ºrdemek"],["Dead tired","Bitkin"],["Drive up the wall","√áƒ±ldƒ±rtmak"],
    ["Dropping like flies","Telef olmak"],["Eager beaver","Hevesli/√áalƒ±≈ükan"],["Eat humble pie","Hatasƒ±nƒ± kabullenmek"],["Face the music","Bedel √∂demek"],["Flesh and blood","Et ve tƒ±rnak"],
    ["Full of beans","Enerjik"],["Get cold feet","Caymak/Korkmak"],["Get off my back","Rahat bƒ±rak"],["Give a hand","El uzatmak"],["Go cold turkey","Aniden bƒ±rakmak"],
    ["Go with flow","Akƒ±≈üƒ±na bƒ±rakmak"],["Goody two shoes","S√ºt kuzusu"],["Green with envy","Kƒ±skan√ßlƒ±ktan √ßatlamak"],["Have a blast","√áok eƒülenmek"],["Eyes in back of head","Ensesinde g√∂z√º var"],
    ["Head in clouds","Hayalperest"],["Heart in mouth","Y√ºreƒüi aƒüzƒ±nda"],["Hold your horses","Dur bakalƒ±m"],["In hot water","Ba≈üƒ± belada"],["Rings a bell","Tanƒ±dƒ±k geldi"],
    ["Straight face","ƒ∞fadesiz surat"],["Keep shirt on","Sakin ol"],["Kick the bucket","Nallarƒ± dikmek"],["Knock on wood","Tahtaya vur"],["Know the ropes","Yol yordam bilmek"],
    ["Let off steam","Stres atmak"],["Fish out of water","Sudan √ßƒ±kmƒ±≈ü balƒ±k"],["Loose cannon","Tehlikeli tip"],["Mountain out of molehill","Pireyi deve yapmak"],["Money burns hole","Para durmuyor"],
    ["Mum's the word","Aramƒ±zda kalsƒ±n"],["Needle in haystack","Samanlƒ±kta iƒüne"],["Off beaten track","G√∂zden uzak"],["Off the cuff","Doƒüa√ßlama"],["Old habits die hard","Huylu huyundan"],
    ["On the house","M√ºesseseden"],["Pins and needles","Diken √ºst√ºnde"],["Out of the blue","Aniden"],["Over the moon","√áok mutlu"],["Pain in the neck","Ba≈ü belasƒ±"],
    ["Party pooper","Oyunbozan"],["Play by ear","Geli≈üine g√∂re"],["Pull strings","Torpil yapmak"],["Put sock in it","Susmak"],["Foot in mouth","Pot kƒ±rmak"],
    ["Raining cats dogs","Bardaktan bo≈üalƒ±rcasƒ±na"],["Read between lines","ƒ∞mayƒ± anlamak"],["Rock the boat","Sorun √ßƒ±karmak"],["Rolling stone","ƒ∞≈üleyen demir"],["Salt in wound","Yaraya tuz"],

    // --- 301-400: MULTI-HARD (Phrasal Verbs & Karma≈üƒ±k) ---
    ["Run like wind","R√ºzgar gibi ko≈ü"],["Save your breath","Nefesini t√ºketme"],["Second wind","Yeniden g√º√ßlenme"],["Shoot the breeze","Havadan sudan"],["Sitting duck","Kolay hedef"],
    ["Skeleton in closet","Kirli ge√ßmi≈ü"],["Sleep on it","√úst√ºne d√º≈ü√ºnmek"],["Slippery slope","K√∂t√º gidi≈üat"],["Smart cookie","Zeki"],["Sound broken record","Plak gibi takƒ±lmak"],
    ["Spill the tea","Dedikodu yap"],["Stab in back","Sƒ±rtƒ±ndan vurmak"],["Stick nose into","Burnunu sokmak"],["Storm in teacup","Bir ka≈üƒ±k suda fƒ±rtƒ±na"],["Swallow pride","Gururunu yenmek"],
    ["Take a hike","Bas git"],["Take five","Mola ver"],["Third time charm","Hakkƒ± √º√ßt√ºr"],["Through grapevine","S√∂ylentiyle"],["Throw under bus","Ate≈üe atmak"],
    ["Tie the knot","Evlenmek"],["Tip of iceberg","Buzdaƒüƒ±nƒ±n ucu"],["Touch and go","Hassas durum"],["Turn blind eye","G√∂rmezden gel"],["Under the gun","Baskƒ± altƒ±nda"],
    ["Up the creek","Hapƒ± yutmu≈ü"],["Walking on eggshells","Temkinli olmak"],["Water under bridge","Ge√ßmi≈üte kaldƒ±"],["Wear the pants","Patron olmak"],["Wet blanket","Ne≈üesiz tip"],
    ["White lie","Beyaz yalan"],["Wild card","S√ºrpriz fakt√∂r"],["Wolf in sheep","Koyun postunda kurt"],["You bet","Kesinlikle"],["Zero tolerance","Sƒ±fƒ±r tolerans"],
    ["Zip it","Sus"],["Ace up sleeve","Gizli koz"],["Achilles heel","Zayƒ±f nokta"],["All bark no bite","Sadece havlar"],["Apple of eye","G√∂z bebeƒüi"],
    ["Easy as pie","√áocuk oyuncaƒüƒ±"],["Eleventh hour","Son dakika"],["Bad blood","Husumet"],["Big cheese","Patron"],["Black and white","Apa√ßƒ±k"],
    ["Blind date","K√∂r randevu"],["Born yesterday","D√ºnk√º √ßocuk"],["Break new ground","√áƒ±ƒüƒ±r a√ßmak"],["Bring home bacon","Evi ge√ßindirmek"],["Bull in china shop","Z√ºccaciyede fil"],
    ["Burn candle both ends","Kendini t√ºketmek"],["Bury hatchet","Barƒ±≈ümak"],["Busy bee","√áalƒ±≈ükan arƒ±"],["Butterflies in stomach","Karnƒ±nda kelebekler"],["Call shots","Emir vermek"],
    ["Can of worms","Karƒ±≈üƒ±k i≈ü"],["Carrot and stick","√ñd√ºl ve ceza"],["Cat got tongue","Dilini mi yuttun"],["Catch 22","√áƒ±kmaz d√∂ng√º"],["Change of heart","Fikir deƒüi≈üikliƒüi"],
    ["Cheap skate","Cimri"],["Chicken out","Korkup ka√ßmak"],["Clean slate","Beyaz sayfa"],["Clear the air","Sorunu √ß√∂zmek"],["Cold feet","Teredd√ºt"],
    ["Come clean","ƒ∞tiraf etmek"],["Copycat","Taklit√ßi"],["Couch for","Kefil olmak"],["Crack a book","Kitap a√ßmak"],["Crack the code","√á√∂zmek"],
    ["Crash course","Hƒ±zlandƒ±rƒ±lmƒ±≈ü kurs"],["Cream of crop","En iyisi"],["Crocodile tears","Timsah g√∂zya≈ülarƒ±"],["Cross my heart","Yemin ederim"],["Cry wolf","Yalanla kandƒ±rmak"],
    ["Cut the mustard","Beklentiyi a≈ümak"],["Dark horse","Kapalƒ± kutu"],["Dead end","√áƒ±kmaz sokak"],["Deep water","Zor durum"],["Dog eat dog","Acƒ±masƒ±z rekabet"],
    ["Double cross","Kazƒ±k atmak"],["Down to earth","Al√ßakg√∂n√ºll√º"],["Draw the line","Sƒ±nƒ±r √ßizmek"],["Drink like fish","√áok i√ßmek"],["Drop the ball","Hata yapmak"],
    ["Early bird","Erkenci"],["Eat crow","T√ºk√ºrd√ºƒü√ºn√º yalamak"],["Eat dirt","Hakaret i≈üitmek"],["Eat horse","A√ßlƒ±ktan √∂lmek"],["Face value","G√∂r√ºn√ºr deƒüer"],
    ["Fair weather friend","ƒ∞yi g√ºn dostu"],["Fall flat","ƒ∞≈üe yaramamak"],["Fat chance","Zayƒ±f ihtimal"],["Feather in cap","Gurur kaynaƒüƒ±"],["Fifth wheel","Gereksiz ki≈üi"],

    // --- 401-500: IMPOSSIBLE (Nadir ve Eski Deyimler) ---
    ["Fight fire with fire","Di≈üe di≈ü"],["Fishy","≈û√ºpheli"],["Flat broke","Meteliksiz"],["Fly on wall","Gizli g√∂zlemci"],["Food for thought","D√º≈ü√ºnd√ºr√ºc√º"],
    ["Fool's paradise","Hayal d√ºnyasƒ±"],["Foot the bill","Hesabƒ± √∂demek"],["Full circle","Ba≈üa d√∂nmek"],["Game plan","Strateji"],["Get act together","Kendini toplamak"],
    ["Get axe","Kovulmak"],["Get grip","Kendine gel"],["Get life","Hayatƒ±na bak"],["Get wind of","Kokusunu almak"],["Gift of gab","Laf ebesi"],
    ["Give break","Rahat bƒ±rak"],["Give slip","Atlatmak/Ka√ßmak"],["Go bananas","√áƒ±ldƒ±rmak"],["Go belly up","ƒ∞flas etmek"],["Go dutch","Hesabƒ± b√∂l√º≈ümek"],
    ["Go overboard","A≈üƒ±rƒ±ya ka√ßmak"],["Golden opportunity","Altƒ±n fƒ±rsat"],["Good samaritan","Hayƒ±rsever"],["Grain of truth","Doƒüruluk payƒ±"],["Graveyard shift","Gece vardiyasƒ±"],
    ["Grease palm","R√º≈üvet vermek"],["Green light","Onay"],["Grey area","Belirsiz durum"],["Gut feeling","ƒ∞√ßg√ºd√º"],["Hair's breadth","Kƒ±l payƒ±"],
    ["Hand to mouth","Kƒ±t kanaat"],["Hard nut to crack","√áetin ceviz"],["Haste makes waste","Acele i≈üe ≈üeytan"],["Have heart","Merhamet et"],["Heads will roll","Kelleler gidecek"],
    ["Heart of gold","Altƒ±n kalp"],["Heavy heart","√úzg√ºn kalp"],["High and dry","Ortada kalmƒ±≈ü"],["High time","Tam zamanƒ±"],["Hit road","Yola koyulmak"],
    ["Hit spot","Tam isabet"],["Hold tongue","Dilini tutmak"],["Hold water","Mantƒ±klƒ± olmak"],["Hook line sinker","K√∂r√º k√∂r√ºne"],["Hot air","Bo≈ü laf"],
    ["Icing on cake","Pastanƒ±n √ßileƒüi"],["Idle hands","Bo≈ü duran el"],["In a nutshell","√ñzetle"],["In black and white","Yazƒ±lƒ± olarak"],["In drivers seat","Kontrol sahibi"],
    ["In full swing","Tam gaz"],["In pickle","Zorda"],["In same boat","Aynƒ± gemide"],["Iron out","P√ºr√ºzleri gidermek"],["Itch to scratch","Yapmaya can atmak"],
    ["Jack of all trades","On parmaƒüƒ±nda on marifet"],["Jump gun","Erken davranmak"],["Jump ship","Terk etmek"],["Keep company","E≈ülik etmek"],["Keep cool","Sakin kal"],
    ["Keep posted","Haberdar et"],["Keep under wraps","Gizli tutmak"],["Kick habit","Alƒ±≈ükanlƒ±ƒüƒ± bƒ±rakmak"],["Kill time","Zaman √∂ld√ºrmek"],["Kiss and makeup","Barƒ±≈ümak"],
    ["Knock socks off","Etkilemek"],["Know beans","Hi√ßbir ≈üey bilmemek"],["Labor of love","G√∂n√ºll√º i≈ü"],["Lame duck","Beceriksiz"],["Land on feet","D√∂rt ayak √ºst√ºne"],
    ["Last ditch","Son √ßare"],["Laughing stock","Alay konusu"],["Lay cards table","Kartlarƒ± a√ßmak"],["Learn by heart","Ezberlemek"],["Leave hanging","Ortada bƒ±rakmak"],
    ["Level playing field","E≈üit ≈üartlar"],["Life of party","Ortamƒ±n ne≈üesi"],["Light at tunnel","Umut ƒ±≈üƒ±ƒüƒ±"],["Lip service","S√∂zde destek"],["Live wire","Enerjik tip"],
    ["Lone wolf","Yalnƒ±z kurt"],["Long shot","Zor ihtimal"],["Lose marbles","Aklƒ±nƒ± ka√ßƒ±rmak"],["Lose shirt","Her ≈üeyi kaybetmek"],["Low hanging fruit","Kolay kazan√ß"],
    ["Lucky break","≈ûans eseri"],["Make waves","Ortalƒ±ƒüƒ± karƒ±≈ütƒ±rmak"],["Man of word","S√∂z√ºn√ºn eri"],["Mean business","Ciddi olmak"],["Midas touch","Altƒ±n dokunu≈ü"]
];

// Veritabanƒ±nƒ± Objeye √áevir
const fullDB = rawDB.map(i => ({en: i[0], tr: i[1]}));

// Seviyelere B√∂l (Her biri 100 adet)
const pools = {
    easy: fullDB.slice(0, 100),
    normal: fullDB.slice(100, 200),
    hard: fullDB.slice(200, 300),
    multihard: fullDB.slice(300, 400),
    impossible: fullDB.slice(400, 500)
};

let score = 0, timeLeft = 0, timerInterval, round = 1, matchesFound = 0, targetMatches = 0, currentDiff = '', selectedEng = null, selectedTr = null;
let currentSessionPool = [];

function toggleDictionary() {
    const menu = document.getElementById('menu');
    const dictView = document.getElementById('dictionary-view');
    
    if (dictView.style.display === 'block') {
        dictView.style.display = 'none';
        menu.style.display = 'block';
    } else {
        menu.style.display = 'none';
        dictView.style.display = 'block';
        showDictionary();
    }
}

function showDictionary() {
    const list = document.getElementById('dict-list');
    document.getElementById('dict-count').innerText = fullDB.length; // 500'√º g√∂ster
    list.innerHTML = "";
    // A-Z Sƒ±ralama
    const sorted = [...fullDB].sort((a,b) => a.en.localeCompare(b.en));
    sorted.forEach((i, idx) => {
        const div = document.createElement('div');
        div.className = "dict-item";
        div.innerHTML = `<strong>${idx+1}. ${i.en}</strong><br><small>${i.tr}</small>`;
        list.appendChild(div);
    });
}

function startGame(diff) {
    currentDiff = diff;
    round = 1; score = 0;
    currentSessionPool = [...pools[diff]].sort(() => Math.random() - 0.5);
    document.getElementById('menu').style.display = 'none';
    document.getElementById('game').style.display = 'block';
    document.getElementById('dict-btn').style.display = 'none';
    resetRound(true);
}

function resetRound(firstStart = false) {
    matchesFound = 0; selectedEng = null; selectedTr = null;
    document.getElementById('action-btn').style.display = 'none';
    document.getElementById('round-display').innerText = `Round: ${round}/5`;
    
    // E≈üle≈üme Sayƒ±larƒ±
    if(currentDiff === 'multihard') targetMatches = 6;
    else if(currentDiff === 'easy' || currentDiff === 'normal') targetMatches = 4;
    else targetMatches = 5;

    let baseTime = 30; // Standart s√ºre
    if(currentDiff === 'easy') { 
        document.getElementById('timer-ui').style.display = 'none'; 
    } else {
        document.getElementById('timer-ui').style.display = 'block';
        if(currentDiff === 'impossible') baseTime = 15;
        if(currentDiff === 'multihard') baseTime = 35;
        timeLeft = baseTime;
        startTimer(baseTime);
    }
    
    initMatchStage();
}

function startTimer(max) {
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
        timeLeft -= 0.1;
        document.getElementById('timer-fill').style.width = (timeLeft/max*100) + "%";
        document.getElementById('time-text').innerText = `${Math.ceil(timeLeft)}s`;
        if(timeLeft <= 0) { 
            clearInterval(timerInterval);
            document.getElementById('game-area').innerHTML = "<h2 style='color:red'>S√úRE Bƒ∞TTƒ∞!</h2>";
            document.getElementById('menu-btn').style.display = 'block';
        }
    }, 100);
}

function initMatchStage() {
    const area = document.getElementById('game-area');
    area.innerHTML = ``;
    const cont = document.createElement('div'); cont.className = 'quiz-container';
    const col1 = document.createElement('div'); col1.className = 'column';
    const col2 = document.createElement('div'); col2.className = 'column';
    
    let startIndex = (round-1) * targetMatches;
    if(startIndex >= currentSessionPool.length) startIndex = 0;
    
    let items = currentSessionPool.slice(startIndex, startIndex + targetMatches);
    
    items.forEach(i => {
        const b = document.createElement('button'); b.className = 'btn btn-'+currentDiff; b.innerText = i.en;
        b.onclick = () => { if(selectedEng) selectedEng.classList.remove('selected'); selectedEng = b; b.classList.add('selected'); checkMatch(); };
        col1.appendChild(b);
    });

    [...items].sort(() => Math.random() - 0.5).forEach(i => {
        const b = document.createElement('button'); b.className = 'btn btn-'+currentDiff; b.innerText = i.tr;
        b.onclick = () => { if(selectedTr) selectedTr.classList.remove('selected'); selectedTr = b; b.classList.add('selected'); checkMatch(); };
        col2.appendChild(b);
    });

    cont.append(col1, col2); area.appendChild(cont);
}

function checkMatch() {
    if(selectedEng && selectedTr) {
        const isCorrect = fullDB.some(i => i.en === selectedEng.innerText && i.tr === selectedTr.innerText);
        if(isCorrect) {
            score += 20;
            selectedEng.className = 'btn correct'; selectedTr.className = 'btn correct';
            selectedEng.disabled = true; selectedTr.disabled = true;
            matchesFound++; selectedEng = null; selectedTr = null;
            if(matchesFound === targetMatches) document.getElementById('action-btn').style.display = 'block';
        } else {
            score = Math.max(0, score - 5);
            document.getElementById('main-card').classList.add('shake-screen');
            setTimeout(() => document.getElementById('main-card').classList.remove('shake-screen'), 300);
            let e = selectedEng, t = selectedTr;
            e.className = 'btn wrong'; t.className = 'btn wrong';
            setTimeout(() => { e.className = 'btn btn-'+currentDiff; t.className = 'btn btn-'+currentDiff; }, 400);
            selectedEng = null; selectedTr = null;
        }
        document.getElementById('score-display').innerText = `Puan: ${score}`;
    }
}

function initLightningQuiz() {
    document.getElementById('action-btn').style.display = 'none';
    timeLeft = 7; startTimer(7);
    const area = document.getElementById('game-area');
    const correct = fullDB[Math.floor(Math.random()*fullDB.length)];
    
    area.innerHTML = `<h3>YILDIRIM SORU!</h3><p style="font-size:1.2em">"${correct.en}"</p>`;
    let opts = [correct.tr];
    while(opts.length < 4) {
        let r = fullDB[Math.floor(Math.random()*fullDB.length)].tr;
        if(!opts.includes(r)) opts.push(r);
    }
    opts.sort(() => Math.random() - 0.5).forEach(opt => {
        const b = document.createElement('button'); b.className = 'btn btn-'+currentDiff; b.innerText = opt;
        b.onclick = () => {
            if(opt === correct.tr) {
                score += 50;
                if(round < 5) { round++; resetRound(); } else { startMiniGame(); }
            } else { finishGame(); }
        };
        area.appendChild(b);
    });
}

function startMiniGame() {
    clearInterval(timerInterval);
    document.getElementById('timer-ui').style.display = 'none';
    document.getElementById('game-area').innerHTML = "<h2>üéâ Fƒ∞NAL: BONUS! üéâ</h2><p>Balonlarƒ± yakala!</p>";
    const miniArea = document.getElementById('mini-game-area'); miniArea.style.display = "block";
    
    let balls = 0;
    const mInterval = setInterval(() => {
        if(balls++ > 15) { clearInterval(mInterval); finishGame(); return; }
        
        const b = document.createElement('button'); b.className = "catch-item"; b.innerText = "üéà";
        b.style.left = Math.random() * 85 + "%"; 
        b.style.top = Math.random() * 80 + "%";
        
        b.onclick = () => { 
            score += 15; 
            b.style.transform = "scale(1.5)"; b.style.opacity = "0";
            document.getElementById('score-display').innerText = `Puan: ${score}`; 
            setTimeout(() => b.remove(), 200);
        };
        miniArea.appendChild(b);
        setTimeout(() => { if(b.parentNode) b.remove(); }, 900);
    }, 600);
}

function finishGame() {
    clearInterval(timerInterval);
    document.getElementById('mini-game-area').style.display = "none";
    document.getElementById('game-area').innerHTML = `<h2>OYUN Bƒ∞TTƒ∞!</h2><h3>üèÜ Skorun: ${score}</h3>`;
    document.getElementById('menu-btn').style.display = 'block';
}

let currentThemeIdx = 0;
const themes = [
    { bg: "#ffffff", accent: "#2196F3" }, { bg: "#222", accent: "#ffeb3b", text:"#fff" }, 
    { bg: "#e0f7fa", accent: "#00bcd4" }, { bg: "#fff3e0", accent: "#ff9800" },
    { bg: "#f3e5f5", accent: "#9c27b0" }, { bg: "#e8f5e9", accent: "#4caf50" }
];
function nextTheme() {
    currentThemeIdx = (currentThemeIdx + 1) % themes.length;
    const t = themes[currentThemeIdx];
    document.body.style.backgroundColor = t.bg;
    if(t.text) document.body.style.color = t.text; else document.body.style.color = "#333";
    document.documentElement.style.setProperty('--accent', t.accent);
}
</script>
</body>
</html>